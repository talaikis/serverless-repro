"use strict";var e=require("./tslib.es6-adbab166.js"),t=require("url"),n=require("buffer"),r=require("http"),a=require("fs"),s=require("os"),o=require("path"),i=require("child_process"),c=require("crypto"),u=require("./index-6277fb03.js"),l=require("./v4-aa48ebe9.js"),d=require("https"),f=require("stream");require("http2");var v,h,p,m,g,_,w,y,b,S,k,E,A,T,x,R,I,P,C,z,O,L,N,D,U,q,j,M,K,W=require("process"),$="3.18.0",H="3.18.0";!function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(v||(v={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(h||(h={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(p||(p={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(m||(m={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(g||(g={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(_||(_={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(w||(w={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(y||(y={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(b||(b={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(S||(S={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(k||(k={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(E||(E={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(A||(A={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(T||(T={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(x||(x={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(R||(R={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(I||(I={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(P||(P={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(C||(C={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(z||(z={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(O||(O={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(L||(L={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(N||(N={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(D||(D={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(U||(U={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(q||(q={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(j||(j={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(M||(M={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(K||(K={}));var F=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s,o,i,c,u,l,d,f,v;return e.__generator(this,(function(h){switch(h.label){case 0:return a=[e.__assign({},t)],v={},[4,be(t.body,n)];case 1:switch(r=e.__assign.apply(void 0,a.concat([(v.body=h.sent(),v)])),o="UnknownError",o=ke(t,r.body),o){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":return[3,2];case"MalformedPolicyDocumentException":case"com.amazonaws.sts#MalformedPolicyDocumentException":return[3,4];case"PackedPolicyTooLargeException":case"com.amazonaws.sts#PackedPolicyTooLargeException":return[3,6];case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":return[3,8]}return[3,10];case 2:return i=[{}],[4,B(r)];case 3:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,i.concat([h.sent()])),{name:o,$metadata:_e(t)}]),[3,11];case 4:return c=[{}],[4,Z(r)];case 5:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,c.concat([h.sent()])),{name:o,$metadata:_e(t)}]),[3,11];case 6:return u=[{}],[4,J(r)];case 7:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,u.concat([h.sent()])),{name:o,$metadata:_e(t)}]),[3,11];case 8:return l=[{}],[4,Q(r)];case 9:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,l.concat([h.sent()])),{name:o,$metadata:_e(t)}]),[3,11];case 10:d=r.body,o=d.Error.code||d.Error.Code||o,s=e.__assign(e.__assign({},d.Error),{name:""+o,message:d.Error.message||d.Error.Message||o,$fault:"client",$metadata:_e(t)}),h.label=11;case 11:return f=s.message||s.Message||o,s.message=f,delete s.Message,[2,Promise.reject(Object.assign(new Error(f),s))]}}))}))},V=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s,o,i,c,u,l,d,f,v,h,p,m;return e.__generator(this,(function(g){switch(g.label){case 0:return a=[e.__assign({},t)],m={},[4,be(t.body,n)];case 1:switch(r=e.__assign.apply(void 0,a.concat([(m.body=g.sent(),m)])),o="UnknownError",o=ke(t,r.body),o){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":return[3,2];case"IDPCommunicationErrorException":case"com.amazonaws.sts#IDPCommunicationErrorException":return[3,4];case"IDPRejectedClaimException":case"com.amazonaws.sts#IDPRejectedClaimException":return[3,6];case"InvalidIdentityTokenException":case"com.amazonaws.sts#InvalidIdentityTokenException":return[3,8];case"MalformedPolicyDocumentException":case"com.amazonaws.sts#MalformedPolicyDocumentException":return[3,10];case"PackedPolicyTooLargeException":case"com.amazonaws.sts#PackedPolicyTooLargeException":return[3,12];case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":return[3,14]}return[3,16];case 2:return i=[{}],[4,B(r)];case 3:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,i.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 4:return c=[{}],[4,G(r)];case 5:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,c.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 6:return u=[{}],[4,X(r)];case 7:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,u.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 8:return l=[{}],[4,Y(r)];case 9:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,l.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 10:return d=[{}],[4,Z(r)];case 11:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,d.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 12:return f=[{}],[4,J(r)];case 13:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,f.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 14:return v=[{}],[4,Q(r)];case 15:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,v.concat([g.sent()])),{name:o,$metadata:_e(t)}]),[3,17];case 16:h=r.body,o=h.Error.code||h.Error.Code||o,s=e.__assign(e.__assign({},h.Error),{name:""+o,message:h.Error.message||h.Error.Message||o,$fault:"client",$metadata:_e(t)}),g.label=17;case 17:return p=s.message||s.Message||o,s.message=p,delete s.Message,[2,Promise.reject(Object.assign(new Error(p),s))]}}))}))},B=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=de(n.Error),[2,e.__assign({name:"ExpiredTokenException",$fault:"client",$metadata:_e(t)},r)]}))}))},G=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=fe(n.Error),[2,e.__assign({name:"IDPCommunicationErrorException",$fault:"client",$metadata:_e(t)},r)]}))}))},X=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=ve(n.Error),[2,e.__assign({name:"IDPRejectedClaimException",$fault:"client",$metadata:_e(t)},r)]}))}))},Y=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=he(n.Error),[2,e.__assign({name:"InvalidIdentityTokenException",$fault:"client",$metadata:_e(t)},r)]}))}))},Z=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=pe(n.Error),[2,e.__assign({name:"MalformedPolicyDocumentException",$fault:"client",$metadata:_e(t)},r)]}))}))},J=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=me(n.Error),[2,e.__assign({name:"PackedPolicyTooLargeException",$fault:"client",$metadata:_e(t)},r)]}))}))},Q=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){return n=t.body,r=ge(n.Error),[2,e.__assign({name:"RegionDisabledException",$fault:"client",$metadata:_e(t)},r)]}))}))},ee=function(t,n){var r={};if(void 0!==t.RoleArn&&null!==t.RoleArn&&(r.RoleArn=t.RoleArn),void 0!==t.RoleSessionName&&null!==t.RoleSessionName&&(r.RoleSessionName=t.RoleSessionName),void 0!==t.PolicyArns&&null!==t.PolicyArns){var a=ne(t.PolicyArns,n);Object.entries(a).forEach((function(t){var n=e.__read(t,2),a=n[0],s=n[1];r["PolicyArns."+a]=s}))}if(void 0!==t.Policy&&null!==t.Policy&&(r.Policy=t.Policy),void 0!==t.DurationSeconds&&null!==t.DurationSeconds&&(r.DurationSeconds=t.DurationSeconds),void 0!==t.Tags&&null!==t.Tags){a=oe(t.Tags,n);Object.entries(a).forEach((function(t){var n=e.__read(t,2),a=n[0],s=n[1];r["Tags."+a]=s}))}if(void 0!==t.TransitiveTagKeys&&null!==t.TransitiveTagKeys){a=se(t.TransitiveTagKeys);Object.entries(a).forEach((function(t){var n=e.__read(t,2),a=n[0],s=n[1];r["TransitiveTagKeys."+a]=s}))}return void 0!==t.ExternalId&&null!==t.ExternalId&&(r.ExternalId=t.ExternalId),void 0!==t.SerialNumber&&null!==t.SerialNumber&&(r.SerialNumber=t.SerialNumber),void 0!==t.TokenCode&&null!==t.TokenCode&&(r.TokenCode=t.TokenCode),void 0!==t.SourceIdentity&&null!==t.SourceIdentity&&(r.SourceIdentity=t.SourceIdentity),r},te=function(t,n){var r={};if(void 0!==t.RoleArn&&null!==t.RoleArn&&(r.RoleArn=t.RoleArn),void 0!==t.RoleSessionName&&null!==t.RoleSessionName&&(r.RoleSessionName=t.RoleSessionName),void 0!==t.WebIdentityToken&&null!==t.WebIdentityToken&&(r.WebIdentityToken=t.WebIdentityToken),void 0!==t.ProviderId&&null!==t.ProviderId&&(r.ProviderId=t.ProviderId),void 0!==t.PolicyArns&&null!==t.PolicyArns){var a=ne(t.PolicyArns,n);Object.entries(a).forEach((function(t){var n=e.__read(t,2),a=n[0],s=n[1];r["PolicyArns."+a]=s}))}return void 0!==t.Policy&&null!==t.Policy&&(r.Policy=t.Policy),void 0!==t.DurationSeconds&&null!==t.DurationSeconds&&(r.DurationSeconds=t.DurationSeconds),r},ne=function(t,n){var r,a,s={},o=1;try{for(var i=e.__values(t),c=i.next();!c.done;c=i.next()){var u=c.value;if(null!==u){var l=re(u,n);Object.entries(l).forEach((function(t){var n=e.__read(t,2),r=n[0],a=n[1];s["member."+o+"."+r]=a})),o++}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return s},re=function(e,t){var n={};return void 0!==e.arn&&null!==e.arn&&(n.arn=e.arn),n},ae=function(e,t){var n={};return void 0!==e.Key&&null!==e.Key&&(n.Key=e.Key),void 0!==e.Value&&null!==e.Value&&(n.Value=e.Value),n},se=function(t,n){var r,a,s={},o=1;try{for(var i=e.__values(t),c=i.next();!c.done;c=i.next()){var u=c.value;null!==u&&(s["member."+o]=u,o++)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return s},oe=function(t,n){var r,a,s={},o=1;try{for(var i=e.__values(t),c=i.next();!c.done;c=i.next()){var u=c.value;if(null!==u){var l=ae(u);Object.entries(l).forEach((function(t){var n=e.__read(t,2),r=n[0],a=n[1];s["member."+o+"."+r]=a})),o++}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return s},ie=function(e,t){var n={AssumedRoleId:void 0,Arn:void 0};return void 0!==e.AssumedRoleId&&(n.AssumedRoleId=e.AssumedRoleId),void 0!==e.Arn&&(n.Arn=e.Arn),n},ce=function(e,t){var n={Credentials:void 0,AssumedRoleUser:void 0,PackedPolicySize:void 0,SourceIdentity:void 0};return void 0!==e.Credentials&&(n.Credentials=le(e.Credentials)),void 0!==e.AssumedRoleUser&&(n.AssumedRoleUser=ie(e.AssumedRoleUser)),void 0!==e.PackedPolicySize&&(n.PackedPolicySize=parseInt(e.PackedPolicySize)),void 0!==e.SourceIdentity&&(n.SourceIdentity=e.SourceIdentity),n},ue=function(e,t){var n={Credentials:void 0,SubjectFromWebIdentityToken:void 0,AssumedRoleUser:void 0,PackedPolicySize:void 0,Provider:void 0,Audience:void 0,SourceIdentity:void 0};return void 0!==e.Credentials&&(n.Credentials=le(e.Credentials)),void 0!==e.SubjectFromWebIdentityToken&&(n.SubjectFromWebIdentityToken=e.SubjectFromWebIdentityToken),void 0!==e.AssumedRoleUser&&(n.AssumedRoleUser=ie(e.AssumedRoleUser)),void 0!==e.PackedPolicySize&&(n.PackedPolicySize=parseInt(e.PackedPolicySize)),void 0!==e.Provider&&(n.Provider=e.Provider),void 0!==e.Audience&&(n.Audience=e.Audience),void 0!==e.SourceIdentity&&(n.SourceIdentity=e.SourceIdentity),n},le=function(e,t){var n={AccessKeyId:void 0,SecretAccessKey:void 0,SessionToken:void 0,Expiration:void 0};return void 0!==e.AccessKeyId&&(n.AccessKeyId=e.AccessKeyId),void 0!==e.SecretAccessKey&&(n.SecretAccessKey=e.SecretAccessKey),void 0!==e.SessionToken&&(n.SessionToken=e.SessionToken),void 0!==e.Expiration&&(n.Expiration=new Date(e.Expiration)),n},de=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},fe=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},ve=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},he=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},pe=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},me=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},ge=function(e,t){var n={message:void 0};return void 0!==e.message&&(n.message=e.message),n},_e=function(e){var t;return{httpStatusCode:e.statusCode,requestId:null!==(t=e.headers["x-amzn-requestid"])&&void 0!==t?t:e.headers["x-amzn-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},we=function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then((function(e){return t.utf8Encoder(e)}))},ye=function(t,n,r,a,s){return e.__awaiter(void 0,void 0,void 0,(function(){var o,i,c,l,d,f;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.endpoint()];case 1:return o=e.sent(),i=o.hostname,c=o.protocol,l=void 0===c?"https":c,d=o.port,f={protocol:l,hostname:i,port:d,method:"POST",path:r,headers:n},void 0!==a&&(f.hostname=a),void 0!==s&&(f.body=s),[2,new u.HttpRequest(f)]}}))}))},be=function(e,t){return we(e,t).then((function(e){if(e.length){var t=u.parser.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1,parseNodeValue:!1,trimValues:!1,tagValueProcessor:function(e,t){return""===e.trim()?"":u.lib.decodeHTML(e)}}),n=Object.keys(t)[0],r=t[n];return r["#text"]&&(r[n]=r["#text"],delete r["#text"]),u.getValueFromTextNode(r)}return{}}))},Se=function(t){return Object.entries(t).map((function(t){var n=e.__read(t,2),r=n[0],a=n[1];return u.extendedEncodeURIComponent(r)+"="+u.extendedEncodeURIComponent(a)})).join("&")},ke=function(e,t){return void 0!==t.Error.Code?t.Error.Code:404==e.statusCode?"NotFound":""},Ee=function(t){function n(e,n){void 0===n&&(n=!0);var r=t.call(this,e)||this;return r.tryNextLink=n,r}return e.__extends(n,t),n.from=function(e,t){return void 0===t&&(t=!0),Object.defineProperty(e,"tryNextLink",{value:t,configurable:!1,enumerable:!1,writable:!1}),e},n}(Error);function Ae(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){var n,r,a=Promise.reject(new Ee("No providers in chain")),s=function(e){a=a.catch((function(t){if(null==t?void 0:t.tryNextLink)return e();throw t}))};try{for(var o=e.__values(t),i=o.next();!i.done;i=o.next()){s(i.value)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}}for(var Te=function(t,n,r){var a,s;if(void 0===n)return function(){return s||(a=t(),s=!0),a};var o=!1;return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var i;return e.__generator(this,(function(e){switch(e.label){case 0:return s||(a=t(),s=!0),o?[2,a]:[4,a];case 1:return i=e.sent(),r&&!r(i)?(o=!0,[2,i]):n(i)?[2,a=t()]:[2,i]}}))}))}},xe={},Re={},Ie=0;Ie<256;Ie++){var Pe=Ie.toString(16).toLowerCase();1===Pe.length&&(Pe="0"+Pe),xe[Ie]=Pe,Re[Pe]=Ie}function Ce(e){for(var t="",n=0;n<e.byteLength;n++)t+=xe[e[n]];return t}var ze="X-Amz-Date".toLowerCase(),Oe=["authorization",ze,"date"],Le="X-Amz-Signature".toLowerCase(),Ne="X-Amz-Security-Token".toLowerCase(),De={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},Ue=/^proxy-/,qe=/^sec-/,je="AWS4-HMAC-SHA256-PAYLOAD",Me={},Ke=[];function We(e,t,n){return e+"/"+t+"/"+n+"/aws4_request"}function $e(e,t,n){var r=new e(t);return r.update(n),r.digest()}function He(t,n,r){var a,s,o=t.headers,i={};try{for(var c=e.__values(Object.keys(o).sort()),u=c.next();!u.done;u=c.next()){var l=u.value,d=l.toLowerCase();(d in De||(null==n?void 0:n.has(d))||Ue.test(d)||qe.test(d))&&(!r||r&&!r.has(d))||(i[d]=o[l].trim().replace(/\s+/g," "))}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return i}var Fe=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,Ve)},Ve=function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()};var Be=function(e){return"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)};function Ge(t,n){var r=t.headers,a=t.body;return e.__awaiter(this,void 0,void 0,(function(){var t,s,o,i,c,u,l;return e.__generator(this,(function(d){switch(d.label){case 0:try{for(t=e.__values(Object.keys(r)),s=t.next();!s.done;s=t.next())if("x-amz-content-sha256"===(o=s.value).toLowerCase())return[2,r[o]]}catch(e){u={error:e}}finally{try{s&&!s.done&&(l=t.return)&&l.call(t)}finally{if(u)throw u.error}}return null!=a?[3,1]:[2,"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"];case 1:return"string"==typeof a||ArrayBuffer.isView(a)||Be(a)?((i=new n).update(a),c=Ce,[4,i.digest()]):[3,3];case 2:return[2,c.apply(void 0,[d.sent()])];case 3:return[2,"UNSIGNED-PAYLOAD"]}}))}))}function Xe(t){var n=t.headers,r=t.query,a=e.__rest(t,["headers","query"]);return e.__assign(e.__assign({},a),{headers:e.__assign({},n),query:r?Ye(r):void 0})}function Ye(t){return Object.keys(t).reduce((function(n,r){var a,s=t[r];return e.__assign(e.__assign({},n),((a={})[r]=Array.isArray(s)?e.__spreadArray([],e.__read(s)):s,a))}),{})}function Ze(t){var n,r;t="function"==typeof t.clone?t.clone():Xe(t);try{for(var a=e.__values(Object.keys(t.headers)),s=a.next();!s.done;s=a.next()){var o=s.value;Oe.indexOf(o.toLowerCase())>-1&&delete t.headers[o]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return t}function Je(e){return function(e){if("number"==typeof e)return new Date(1e3*e);if("string"==typeof e)return Number(e)?new Date(1e3*Number(e)):new Date(e);return e}(e).toISOString().replace(/\.\d{3}Z$/,"Z")}var Qe=function(){function t(e){var t=e.applyChecksum,n=e.credentials,r=e.region,a=e.service,s=e.sha256,o=e.uriEscapePath,i=void 0===o||o;this.service=a,this.sha256=s,this.uriEscapePath=i,this.applyChecksum="boolean"!=typeof t||t,this.regionProvider=nt(r),this.credentialProvider=rt(n)}return t.prototype.presign=function(t,n){return void 0===n&&(n={}),e.__awaiter(this,void 0,void 0,(function(){var r,a,s,o,i,c,u,l,d,f,v,h,p,m,g,_,w,y,b,S,k,E,A,T;return e.__generator(this,(function(x){switch(x.label){case 0:return r=n.signingDate,a=void 0===r?new Date:r,s=n.expiresIn,o=void 0===s?3600:s,i=n.unsignableHeaders,c=n.unhoistableHeaders,u=n.signableHeaders,l=n.signingRegion,d=n.signingService,[4,this.credentialProvider()];case 1:return f=x.sent(),null==l?[3,2]:(h=l,[3,4]);case 2:return[4,this.regionProvider()];case 3:h=x.sent(),x.label=4;case 4:return v=h,p=et(a),m=p.longDate,g=p.shortDate,o>604800?[2,Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future")]:(_=We(g,v,null!=d?d:this.service),w=function(t,n){var r,a,s;void 0===n&&(n={});var o="function"==typeof t.clone?t.clone():Xe(t),i=o.headers,c=o.query,u=void 0===c?{}:c;try{for(var l=e.__values(Object.keys(i)),d=l.next();!d.done;d=l.next()){var f=d.value,v=f.toLowerCase();"x-amz-"!==v.substr(0,6)||(null===(s=n.unhoistableHeaders)||void 0===s?void 0:s.has(v))||(u[f]=i[f],delete i[f])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return e.__assign(e.__assign({},t),{headers:i,query:u})}(Ze(t),{unhoistableHeaders:c}),f.sessionToken&&(w.query["X-Amz-Security-Token"]=f.sessionToken),w.query["X-Amz-Algorithm"]="AWS4-HMAC-SHA256",w.query["X-Amz-Credential"]=f.accessKeyId+"/"+_,w.query["X-Amz-Date"]=m,w.query["X-Amz-Expires"]=o.toString(10),y=He(w,i,u),w.query["X-Amz-SignedHeaders"]=tt(y),b=w.query,S="X-Amz-Signature",k=this.getSignature,E=[m,_,this.getSigningKey(f,v,g,d)],A=this.createCanonicalRequest,T=[w,y],[4,Ge(t,this.sha256)]);case 5:return[4,k.apply(this,E.concat([A.apply(this,T.concat([x.sent()]))]))];case 6:return b[S]=x.sent(),[2,w]}}))}))},t.prototype.sign=function(t,n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return"string"==typeof t?[2,this.signString(t,n)]:t.headers&&t.payload?[2,this.signEvent(t,n)]:[2,this.signRequest(t,n)]}))}))},t.prototype.signEvent=function(t,n){var r=t.headers,a=t.payload,s=n.signingDate,o=void 0===s?new Date:s,i=n.priorSignature,c=n.signingRegion,u=n.signingService;return e.__awaiter(this,void 0,void 0,(function(){var t,n,s,l,d,f,v,h,p,m,g;return e.__generator(this,(function(e){switch(e.label){case 0:return null==c?[3,1]:(n=c,[3,3]);case 1:return[4,this.regionProvider()];case 2:n=e.sent(),e.label=3;case 3:return t=n,s=et(o),l=s.shortDate,d=s.longDate,f=We(l,t,null!=u?u:this.service),[4,Ge({headers:{},body:a},this.sha256)];case 4:return v=e.sent(),(h=new this.sha256).update(r),m=Ce,[4,h.digest()];case 5:return p=m.apply(void 0,[e.sent()]),g=[je,d,f,i,p,v].join("\n"),[2,this.signString(g,{signingDate:o,signingRegion:t,signingService:u})]}}))}))},t.prototype.signString=function(t,n){var r=void 0===n?{}:n,a=r.signingDate,s=void 0===a?new Date:a,o=r.signingRegion,i=r.signingService;return e.__awaiter(this,void 0,void 0,(function(){var n,r,a,c,u,l,d,f;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,this.credentialProvider()];case 1:return n=e.sent(),null==o?[3,2]:(a=o,[3,4]);case 2:return[4,this.regionProvider()];case 3:a=e.sent(),e.label=4;case 4:return r=a,c=et(s).shortDate,d=(l=this.sha256).bind,[4,this.getSigningKey(n,r,c,i)];case 5:return(u=new(d.apply(l,[void 0,e.sent()]))).update(t),f=Ce,[4,u.digest()];case 6:return[2,f.apply(void 0,[e.sent()])]}}))}))},t.prototype.signRequest=function(t,n){var r=void 0===n?{}:n,a=r.signingDate,s=void 0===a?new Date:a,o=r.signableHeaders,i=r.unsignableHeaders,c=r.signingRegion,u=r.signingService;return e.__awaiter(this,void 0,void 0,(function(){var n,r,a,l,d,f,v,h,p,m,g;return e.__generator(this,(function(_){switch(_.label){case 0:return[4,this.credentialProvider()];case 1:return n=_.sent(),null==c?[3,2]:(a=c,[3,4]);case 2:return[4,this.regionProvider()];case 3:a=_.sent(),_.label=4;case 4:return r=a,l=Ze(t),d=et(s),f=d.longDate,v=d.shortDate,h=We(v,r,null!=u?u:this.service),l.headers[ze]=f,n.sessionToken&&(l.headers[Ne]=n.sessionToken),[4,Ge(l,this.sha256)];case 5:return p=_.sent(),!function(t,n){var r,a;t=t.toLowerCase();try{for(var s=e.__values(Object.keys(n)),o=s.next();!o.done;o=s.next())if(t===o.value.toLowerCase())return!0}catch(e){r={error:e}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return!1}("x-amz-content-sha256",l.headers)&&this.applyChecksum&&(l.headers["x-amz-content-sha256"]=p),m=He(l,i,o),[4,this.getSignature(f,h,this.getSigningKey(n,r,v,u),this.createCanonicalRequest(l,m,p))];case 6:return g=_.sent(),l.headers.authorization="AWS4-HMAC-SHA256 Credential="+n.accessKeyId+"/"+h+", SignedHeaders="+tt(m)+", Signature="+g,[2,l]}}))}))},t.prototype.createCanonicalRequest=function(t,n,r){var a=Object.keys(n).sort();return t.method+"\n"+this.getCanonicalPath(t)+"\n"+function(t){var n,r,a=t.query,s=void 0===a?{}:a,o=[],i={},c=function(e){if(e.toLowerCase()===Le)return"continue";o.push(e);var t=s[e];"string"==typeof t?i[e]=Fe(e)+"="+Fe(t):Array.isArray(t)&&(i[e]=t.slice(0).sort().reduce((function(t,n){return t.concat([Fe(e)+"="+Fe(n)])}),[]).join("&"))};try{for(var u=e.__values(Object.keys(s).sort()),l=u.next();!l.done;l=u.next())c(l.value)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return o.map((function(e){return i[e]})).filter((function(e){return e})).join("&")}(t)+"\n"+a.map((function(e){return e+":"+n[e]})).join("\n")+"\n\n"+a.join(";")+"\n"+r},t.prototype.createStringToSign=function(t,n,r){return e.__awaiter(this,void 0,void 0,(function(){var a,s;return e.__generator(this,(function(e){switch(e.label){case 0:return(a=new this.sha256).update(r),[4,a.digest()];case 1:return s=e.sent(),[2,"AWS4-HMAC-SHA256\n"+t+"\n"+n+"\n"+Ce(s)]}}))}))},t.prototype.getCanonicalPath=function(e){var t=e.path;return this.uriEscapePath?"/"+encodeURIComponent(t.replace(/^\//,"")).replace(/%2F/g,"/"):t},t.prototype.getSignature=function(t,n,r,a){return e.__awaiter(this,void 0,void 0,(function(){var s,o,i,c,u;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,this.createStringToSign(t,n,a)];case 1:return s=e.sent(),c=(i=this.sha256).bind,[4,r];case 2:return(o=new(c.apply(i,[void 0,e.sent()]))).update(s),u=Ce,[4,o.digest()];case 3:return[2,u.apply(void 0,[e.sent()])]}}))}))},t.prototype.getSigningKey=function(t,n,r,a){return function(t,n,r,a,s){return e.__awaiter(void 0,void 0,void 0,(function(){var o,i,c,u,l,d,f,v,h;return e.__generator(this,(function(p){switch(p.label){case 0:return[4,$e(t,n.secretAccessKey,n.accessKeyId)];case 1:if(o=p.sent(),(i=r+":"+a+":"+s+":"+Ce(o)+":"+n.sessionToken)in Me)return[2,Me[i]];for(Ke.push(i);Ke.length>50;)delete Me[Ke.shift()];c="AWS4"+n.secretAccessKey,p.label=2;case 2:p.trys.push([2,7,8,9]),u=e.__values([r,a,s,"aws4_request"]),l=u.next(),p.label=3;case 3:return l.done?[3,6]:(d=l.value,[4,$e(t,c,d)]);case 4:c=p.sent(),p.label=5;case 5:return l=u.next(),[3,3];case 6:return[3,9];case 7:return f=p.sent(),v={error:f},[3,9];case 8:try{l&&!l.done&&(h=u.return)&&h.call(u)}finally{if(v)throw v.error}return[7];case 9:return[2,Me[i]=c]}}))}))}(this.sha256,t,r,n,a||this.service)},t}(),et=function(e){var t=Je(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.substr(0,8)}},tt=function(e){return Object.keys(e).sort().join(";")},nt=function(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},rt=function(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},at=function(t){var n,r=t.credentials?ot(t.credentials):t.credentialDefaultProvider(t),a=t.signingEscapePath,s=void 0===a||a,o=t.systemClockOffset,i=void 0===o?t.systemClockOffset||0:o,c=t.sha256;return n=t.signer?st(t.signer):function(){return st(t.region)().then((function(n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.regionInfoProvider(n)];case 1:return[2,[e.sent()||{},n]]}}))}))})).then((function(n){var a=e.__read(n,2),o=a[0],i=a[1],u=o.signingRegion,l=o.signingService;return t.signingRegion=t.signingRegion||u||i,t.signingName=t.signingName||l||t.serviceId,new Qe({credentials:r,region:t.signingRegion,service:t.signingName,sha256:c,uriEscapePath:s})}))},e.__assign(e.__assign({},t),{systemClockOffset:i,signingEscapePath:s,credentials:r,signer:n})},st=function(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},ot=function(e){return"function"==typeof e?Te(e,(function(e){return void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5}),(function(e){return void 0!==e.expiration})):st(e)},it=function(e){return new Date(Date.now()+e)};function ct(t){return function(n,r){return function(a){return e.__awaiter(this,void 0,void 0,(function(){var s,o,i,c,l,d,f,v,h;return e.__generator(this,(function(p){switch(p.label){case 0:return u.HttpRequest.isInstance(a.request)?"function"!=typeof t.signer?[3,2]:[4,t.signer()]:[2,n(a)];case 1:return o=p.sent(),[3,3];case 2:o=t.signer,p.label=3;case 3:return s=o,c=n,l=[e.__assign({},a)],h={},[4,s.sign(a.request,{signingDate:new Date(Date.now()+t.systemClockOffset),signingRegion:r.signing_region,signingService:r.signing_service})];case 4:return[4,c.apply(void 0,[e.__assign.apply(void 0,l.concat([(h.request=p.sent(),h)]))])];case 5:return i=p.sent(),d=i.response.headers,(f=d&&(d.date||d.Date))&&(v=Date.parse(f),m=v,g=t.systemClockOffset,Math.abs(it(g).getTime()-m)>=3e5&&(t.systemClockOffset=v-Date.now())),[2,i]}var m,g}))}))}}}var ut={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},lt=function(e){return{applyToStack:function(t){t.addRelativeTo(ct(e),ut)}}},dt=function(t){function n(e){var n=t.call(this)||this;return n.input=e,n}return e.__extends(n,t),n.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(u.getSerdePlugin(t,this.serialize,this.deserialize)),this.middlewareStack.use(lt(t));var r=e.concat(this.middlewareStack),a={logger:t.logger,clientName:"STSClient",commandName:"AssumeRoleCommand",inputFilterSensitiveLog:m.filterSensitiveLog,outputFilterSensitiveLog:_.filterSensitiveLog},s=t.requestHandler;return r.resolve((function(e){return s.handle(e.request,n||{})}),a)},n.prototype.serialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a;return e.__generator(this,(function(s){return r={"content-type":"application/x-www-form-urlencoded"},a=Se(e.__assign(e.__assign({},ee(t,n)),{Action:"AssumeRole",Version:"2011-06-15"})),[2,ye(n,r,"/",void 0,a)]}))}))}(t,n)},n.prototype.deserialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s;return e.__generator(this,(function(o){switch(o.label){case 0:return t.statusCode>=300?[2,F(t,n)]:[4,be(t.body,n)];case 1:return r=o.sent(),a=ce(r.AssumeRoleResult),s=e.__assign({$metadata:_e(t)},a),[2,Promise.resolve(s)]}}))}))}(t,n)},n}(u.Command),ft=function(t){function n(e){var n=t.call(this)||this;return n.input=e,n}return e.__extends(n,t),n.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(u.getSerdePlugin(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),a={logger:t.logger,clientName:"STSClient",commandName:"AssumeRoleWithWebIdentityCommand",inputFilterSensitiveLog:x.filterSensitiveLog,outputFilterSensitiveLog:R.filterSensitiveLog},s=t.requestHandler;return r.resolve((function(e){return s.handle(e.request,n||{})}),a)},n.prototype.serialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a;return e.__generator(this,(function(s){return r={"content-type":"application/x-www-form-urlencoded"},a=Se(e.__assign(e.__assign({},te(t,n)),{Action:"AssumeRoleWithWebIdentity",Version:"2011-06-15"})),[2,ye(n,r,"/",void 0,a)]}))}))}(t,n)},n.prototype.deserialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s;return e.__generator(this,(function(o){switch(o.label){case 0:return t.statusCode>=300?[2,V(t,n)]:[4,be(t.body,n)];case 1:return r=o.sent(),a=ue(r.AssumeRoleWithWebIdentityResult),s=e.__assign({$metadata:_e(t)},a),[2,Promise.resolve(s)]}}))}))}(t,n)},n}(u.Command),vt=function(t){return"function"!=typeof t?void 0===t?"us-east-1":t:function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,"us-east-1"];case 3:return[2]}}))}))}},ht=function(t,n){var r,a;return function(s,o){return e.__awaiter(void 0,void 0,void 0,(function(){var i,c,u,l;return e.__generator(this,(function(d){switch(d.label){case 0:return a=s,r||(i=t.logger,c=t.region,u=t.requestHandler,r=new n(e.__assign({logger:i,credentialDefaultProvider:function(){return function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,a]}))}))}},region:vt(c||t.region)},u?{requestHandler:u}:{}))),[4,r.send(new dt(o))];case 1:if(!(l=d.sent().Credentials)||!l.AccessKeyId||!l.SecretAccessKey)throw new Error("Invalid response from STS.assumeRole call with role "+o.RoleArn);return[2,{accessKeyId:l.AccessKeyId,secretAccessKey:l.SecretAccessKey,sessionToken:l.SessionToken,expiration:l.Expiration}]}}))}))}},pt=function(t,n){var r;return function(a){return e.__awaiter(void 0,void 0,void 0,(function(){var s,o,i,c;return e.__generator(this,(function(u){switch(u.label){case 0:return r||(s=t.logger,o=t.region,i=t.requestHandler,r=new n(e.__assign({logger:s,region:vt(o||t.region)},i?{requestHandler:i}:{}))),[4,r.send(new ft(a))];case 1:if(!(c=u.sent().Credentials)||!c.AccessKeyId||!c.SecretAccessKey)throw new Error("Invalid response from STS.assumeRoleWithWebIdentity call with role "+a.RoleArn);return[2,{accessKeyId:c.AccessKeyId,secretAccessKey:c.SecretAccessKey,sessionToken:c.SessionToken,expiration:c.Expiration}]}}))}))}},mt=function(t){var n;return e.__assign(e.__assign({},t),{tls:null===(n=t.tls)||void 0===n||n,endpoint:t.endpoint?gt(t):function(){return _t(t)},isCustomEndpoint:!!t.endpoint})},gt=function(e){var t=e.endpoint,n=e.urlParser;if("string"==typeof t){var r=Promise.resolve(n(t));return function(){return r}}if("object"==typeof t){var a=Promise.resolve(t);return function(){return a}}return t},_t=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r,a,s,o;return e.__generator(this,(function(e){switch(e.label){case 0:return n=t.tls,r=void 0===n||n,[4,t.region()];case 1:if(a=e.sent(),!new RegExp(/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])$/).test(a))throw new Error("Invalid region in client config");return[4,t.regionInfoProvider(a)];case 2:if(!(s=(null!==(o=e.sent())&&void 0!==o?o:{}).hostname))throw new Error("Cannot resolve hostname from client config");return[2,t.urlParser((r?"https:":"http:")+"//"+s)]}}))}))},wt={environmentVariableSelector:function(e){return e.AWS_REGION},configFileSelector:function(e){return e.region},default:function(){throw new Error("Region is missing")}},yt={preferredFile:"credentials"},bt=function(t){if(!t.region)throw new Error("Region is missing");return e.__assign(e.__assign({},t),{region:St(t.region)})},St=function(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e};function kt(){return function(){var e=process.env.AWS_ACCESS_KEY_ID,t=process.env.AWS_SECRET_ACCESS_KEY,n=process.env.AWS_CREDENTIAL_EXPIRATION;return e&&t?Promise.resolve({accessKeyId:e,secretAccessKey:t,sessionToken:process.env.AWS_SESSION_TOKEN,expiration:n?new Date(n):void 0}):Promise.reject(new Ee("Unable to find environment variable credentials."))}}function Et(t){return new Promise((function(a,s){var o=r.request(e.__assign({method:"GET"},t));o.on("error",(function(e){s(Object.assign(new Ee("Unable to connect to instance metadata service"),e))})),o.on("timeout",(function(){s(new Error("TimeoutError"))})),o.on("response",(function(e){var t=e.statusCode,r=void 0===t?400:t;(r<200||300<=r)&&s(Object.assign(new Ee("Error response received from instance metadata service"),{statusCode:r}));var o=[];e.on("data",(function(e){o.push(e)})),e.on("end",(function(){a(n.Buffer.concat(o))}))})),o.end()}))}var At=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.AccessKeyId&&"string"==typeof e.SecretAccessKey&&"string"==typeof e.Token&&"string"==typeof e.Expiration},Tt=function(e){return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration)}},xt=function(e){var t=e.maxRetries,n=void 0===t?0:t,r=e.timeout;return{maxRetries:n,timeout:void 0===r?1e3:r}},Rt=function(e,t){for(var n=e(),r=0;r<t;r++)n=n.catch(e);return n},It="AWS_CONTAINER_CREDENTIALS_FULL_URI",Pt="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",Ct=function(t){void 0===t&&(t={});var n=xt(t),r=n.timeout,a=n.maxRetries;return function(){return Rt((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,n,a,s;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,Nt()];case 1:return t=e.sent(),s=(a=JSON).parse,[4,zt(r,t)];case 2:if(n=s.apply(a,[e.sent()]),!At(n))throw new Ee("Invalid response received from instance metadata service.");return[2,Tt(n)]}}))}))}),a)}},zt=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(r){switch(r.label){case 0:return process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN&&(n.headers=e.__assign(e.__assign({},n.headers),{Authorization:process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN})),[4,Et(e.__assign(e.__assign({},n),{timeout:t}))];case 1:return[2,r.sent().toString()]}}))}))},Ot={localhost:!0,"127.0.0.1":!0},Lt={"http:":!0,"https:":!0},Nt=function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(r){if(process.env[Pt])return[2,{hostname:"169.254.170.2",path:process.env[Pt]}];if(process.env[It]){if(!(n=t.parse(process.env[It])).hostname||!(n.hostname in Ot))throw new Ee(n.hostname+" is not a valid container metadata service hostname",!1);if(!n.protocol||!(n.protocol in Lt))throw new Ee(n.protocol+" is not a valid container metadata service protocol",!1);return[2,e.__assign(e.__assign({},n),{port:n.port?parseInt(n.port,10):void 0})]}throw new Ee("The container metadata credential provider cannot be used unless the "+Pt+" or "+It+" environment variable is set",!1)}))}))},Dt="169.254.169.254",Ut="/latest/meta-data/iam/security-credentials/",qt=function(t){void 0===t&&(t={});var n=!1,r=xt(t),a=r.timeout,s=r.maxRetries,o=function(t,r){return e.__awaiter(void 0,void 0,void 0,(function(){var a;return e.__generator(this,(function(s){switch(s.label){case 0:return[4,Rt((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,a;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Mt(r)];case 1:return t=e.sent(),[3,3];case 2:throw 401===(a=e.sent()).statusCode&&(n=!1),a;case 3:return[2,t]}}))}))}),t)];case 1:return a=s.sent().trim(),[2,Rt((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,s;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Kt(a,r)];case 1:return t=e.sent(),[3,3];case 2:throw 401===(s=e.sent()).statusCode&&(n=!1),s;case 3:return[2,t]}}))}))}),t)]}}))}))};return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,r;return e.__generator(this,(function(e){switch(e.label){case 0:return n?[2,o(s,{timeout:a})]:[3,1];case 1:t=void 0,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,jt({timeout:a})];case 3:return t=e.sent().toString(),[3,5];case 4:if(400===(null==(r=e.sent())?void 0:r.statusCode))throw Object.assign(r,{message:"EC2 Metadata token request returned error"});return("TimeoutError"===r.message||[403,404,405].includes(r.statusCode))&&(n=!0),[2,o(s,{timeout:a})];case 5:return[2,o(s,{timeout:a,headers:{"x-aws-ec2-metadata-token":t}})]}}))}))}},jt=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(n){return[2,Et(e.__assign(e.__assign({},t),{host:Dt,path:"/latest/api/token",method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}))]}))}))},Mt=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(n){switch(n.label){case 0:return[4,Et(e.__assign(e.__assign({},t),{host:Dt,path:Ut}))];case 1:return[2,n.sent().toString()]}}))}))},Kt=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s;return e.__generator(this,(function(o){switch(o.label){case 0:return s=(a=JSON).parse,[4,Et(e.__assign(e.__assign({},n),{host:Dt,path:Ut+t}))];case 1:if(r=s.apply(a,[o.sent().toString()]),!At(r))throw new Ee("Invalid response received from instance metadata service.");return[2,Tt(r)]}}))}))},Wt=function(t){function n(e,n){void 0===n&&(n=!0);var r=t.call(this,e)||this;return r.tryNextLink=n,r}return e.__extends(n,t),n.from=function(e,t){return void 0===t&&(t=!0),Object.defineProperty(e,"tryNextLink",{value:t,configurable:!1,enumerable:!1,writable:!1}),e},n}(Error),$t=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,Ht(t)]}))}))}},Ht=function(t){var n,r,s,o=null!==(n=null==t?void 0:t.webIdentityTokenFile)&&void 0!==n?n:process.env.AWS_WEB_IDENTITY_TOKEN_FILE,i=null!==(r=null==t?void 0:t.roleArn)&&void 0!==r?r:process.env.AWS_ROLE_ARN,c=null!==(s=null==t?void 0:t.roleSessionName)&&void 0!==s?s:process.env.AWS_ROLE_SESSION_NAME;if(!o||!i)throw new Wt("Web identity configuration not specified");return function(e){return function(){var t=e.roleArn,n=e.roleSessionName,r=e.webIdentityToken,a=e.providerId,s=e.policyArns,o=e.policy,i=e.durationSeconds,c=e.roleAssumerWithWebIdentity;if(!c)throw new Wt("Role Arn '"+t+"' needs to be assumed with web identity, but no role assumption callback was provided.",!1);return c({RoleArn:t,RoleSessionName:null!=n?n:"aws-sdk-js-session-"+Date.now(),WebIdentityToken:r,ProviderId:a,PolicyArns:s,Policy:o,DurationSeconds:i})}}(e.__assign(e.__assign({},t),{webIdentityToken:a.readFileSync(o,{encoding:"ascii"}),roleArn:i,roleSessionName:c}))()},Ft=function(){return{}},Vt=function(t){void 0===t&&(t={});var n=t.filepath,r=void 0===n?process.env.AWS_SHARED_CREDENTIALS_FILE||o.join(Jt(),".aws","credentials"):n,a=t.configFilepath,s=void 0===a?process.env.AWS_CONFIG_FILE||o.join(Jt(),".aws","config"):a;return Promise.all([Zt(s).then(Yt).then(Gt).catch(Ft),Zt(r).then(Yt).catch(Ft)]).then((function(t){var n=e.__read(t,2);return{configFile:n[0],credentialsFile:n[1]}}))},Bt=/^profile\s(["'])?([^\1]+)\1$/,Gt=function(t){var n,r,a={};try{for(var s=e.__values(Object.keys(t)),o=s.next();!o.done;o=s.next()){var i=o.value,c=void 0;if("default"===i)a.default=t.default;else if(c=Bt.exec(i)){var u=e.__read(c,3),l=(u[0],u[1],u[2]);l&&(a[l]=t[i])}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a},Xt=["__proto__","profile __proto__"],Yt=function(t){var n,r,a,s={};try{for(var o=e.__values(t.split(/\r?\n/)),i=o.next();!i.done;i=o.next()){var c=i.value,u=(c=c.split(/(^|\s)[;#]/)[0]).match(/^\s*\[([^\[\]]+)]\s*$/);if(u){if(a=u[1],Xt.includes(a))throw new Error('Found invalid profile name "'+a+'"')}else if(a){var l=c.match(/^\s*(.+?)\s*=\s*(.+?)\s*$/);l&&(s[a]=s[a]||{},s[a][l[1]]=l[2])}}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s},Zt=function(e){return new Promise((function(t,n){a.readFile(e,"utf8",(function(e,r){e?n(e):t(r)}))}))},Jt=function(){var e=process.env,t=e.HOME,n=e.USERPROFILE,r=e.HOMEPATH,a=e.HOMEDRIVE,i=void 0===a?"C:"+o.sep:a;return t||(n||(r?""+i+r:s.homedir()))},Qt=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.aws_access_key_id&&"string"==typeof e.aws_secret_access_key&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1},en=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.role_arn&&["undefined","string"].indexOf(typeof e.role_session_name)>-1&&["undefined","string"].indexOf(typeof e.external_id)>-1&&["undefined","string"].indexOf(typeof e.mfa_serial)>-1},tn=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,nn(t)];case 1:return n=e.sent(),[2,an(rn(t),n,t)]}}))}))}},nn=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(a){switch(a.label){case 0:return n=t.loadedConfig,[4,void 0===n?Vt(t):n];case 1:return r=a.sent(),[2,e.__assign(e.__assign({},r.configFile),r.credentialsFile)]}}))}))},rn=function(e){return e.profile||process.env.AWS_PROFILE||"default"},an=function(t,n,r,a){return void 0===a&&(a={}),e.__awaiter(void 0,void 0,void 0,(function(){var s,o,i,c,u,l,d,f,v,h,p,m,g,_;return e.__generator(this,(function(w){switch(w.label){case 0:if(s=n[t],Object.keys(a).length>0&&Qt(s))return[2,on(s)];if(!(en(y=s)&&"string"==typeof y.source_profile&&void 0===y.credential_source||function(e){return en(e)&&"string"==typeof e.credential_source&&void 0===e.source_profile}(s)))return[3,4];if(o=s.external_id,i=s.mfa_serial,c=s.role_arn,u=s.role_session_name,l=void 0===u?"aws-sdk-js-"+Date.now():u,d=s.source_profile,f=s.credential_source,!r.roleAssumer)throw new Ee("Profile "+t+" requires a role to be assumed, but no role assumption callback was provided.",!1);if(d&&d in a)throw new Ee("Detected a cycle attempting to resolve credentials for profile "+rn(r)+". Profiles visited: "+Object.keys(a).join(", "),!1);if(v=d?an(d,n,r,e.__assign(e.__assign({},a),((_={})[d]=!0,_))):sn(f,t)(),h={RoleArn:c,RoleSessionName:l,ExternalId:o},!i)return[3,2];if(!r.mfaCodeProvider)throw new Ee("Profile "+t+" requires multi-factor authentication, but no MFA code callback was provided.",!1);return h.SerialNumber=i,p=h,[4,r.mfaCodeProvider(i)];case 1:p.TokenCode=w.sent(),w.label=2;case 2:return g=(m=r).roleAssumer,[4,v];case 3:return[2,g.apply(m,[w.sent(),h])];case 4:if(Qt(s))return[2,on(s)];if(function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.web_identity_token_file&&"string"==typeof e.role_arn&&["undefined","string"].indexOf(typeof e.role_session_name)>-1}(s))return[2,cn(s,r)];throw new Ee("Profile "+t+" could not be found or parsed in shared credentials file.")}var y}))}))},sn=function(e,t){var n={EcsContainer:Ct,Ec2InstanceMetadata:qt,Environment:kt};if(e in n)return n[e]();throw new Ee("Unsupported credential source in profile "+t+". Got "+e+", expected EcsContainer or Ec2InstanceMetadata or Environment.")},on=function(e){return Promise.resolve({accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token})},cn=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,$t({webIdentityTokenFile:t.web_identity_token_file,roleArn:t.role_arn,roleSessionName:t.role_session_name,roleAssumerWithWebIdentity:n.roleAssumerWithWebIdentity})()]}))}))},un=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,nn(t)];case 1:return n=e.sent(),[2,ln(rn(t),n)]}}))}))}},ln=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a;return e.__generator(this,(function(e){switch(e.label){case 0:return r=n[t],n[t]?void 0===(a=r.credential_process)?[3,2]:[4,dn(a).then((function(e){var n;try{n=JSON.parse(e)}catch(e){throw Error("Profile "+t+" credential_process returned invalid JSON.")}var r,a=n.Version,s=n.AccessKeyId,o=n.SecretAccessKey,i=n.SessionToken,c=n.Expiration;if(1!==a)throw Error("Profile "+t+" credential_process did not return Version 1.");if(void 0===s||void 0===o)throw Error("Profile "+t+" credential_process returned invalid credentials.");if(c){var u=new Date;if(new Date(c)<u)throw Error("Profile "+t+" credential_process returned expired credentials.");r=Math.floor(new Date(c).valueOf()/1e3)}return{accessKeyId:s,secretAccessKey:o,sessionToken:i,expirationUnix:r}})).catch((function(e){throw new Ee(e.message)}))]:[3,4];case 1:return[2,e.sent()];case 2:throw new Ee("Profile "+t+" did not contain credential_process.");case 3:return[3,5];case 4:throw new Ee("Profile "+t+" could not be found in shared credentials file.");case 5:return[2]}}))}))},dn=function(e){return new Promise((function(t,n){i.exec(e,(function(e,r){e?n(e):t(r.trim())}))}))},fn="3.18.0",vn=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.byteLength-t),!Be(e))throw new TypeError('The "input" argument must be ArrayBuffer. Received type '+typeof e+" ("+e+")");return n.Buffer.from(e,t,r)},hn=function(e,t){if("string"!=typeof e)throw new TypeError('The "input" argument must be of type string. Received type '+typeof e+" ("+e+")");return t?n.Buffer.from(e,t):n.Buffer.from(e)},pn=function(){function e(e,t){this.hash=t?c.createHmac(e,mn(t)):c.createHash(e)}return e.prototype.update=function(e,t){this.hash.update(mn(e,t))},e.prototype.digest=function(){return Promise.resolve(this.hash.digest())},e}();function mn(e,t){return n.Buffer.isBuffer(e)?e:"string"==typeof e?hn(e,t):ArrayBuffer.isView(e)?vn(e.buffer,e.byteOffset,e.byteLength):vn(e)}var gn,_n={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},wn=function(t){return{applyToStack:function(n){n.add(function(t){return function(n,r){return function(a){return e.__awaiter(void 0,void 0,void 0,(function(){var s;return e.__generator(this,(function(o){switch(o.label){case 0:return[4,t.retryStrategy()];case 1:return(null==(s=o.sent())?void 0:s.mode)&&(r.userAgent=e.__spreadArray(e.__spreadArray([],e.__read(r.userAgent||[])),[["cfg/retry-mode",s.mode]])),[2,s.retry(n,a)]}}))}))}}}(t),_n)}}},yn=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch"],bn=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],Sn=["AbortError","TimeoutError","RequestTimeout","RequestTimeoutException"],kn=[500,502,503,504],En=function(e){var t,n;return 429===(null===(t=e.$metadata)||void 0===t?void 0:t.httpStatusCode)||bn.includes(e.name)||1==(null===(n=e.$retryable)||void 0===n?void 0:n.throttling)};!function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"}(gn||(gn={}));var An=gn.STANDARD,Tn=function(e,t){return Math.floor(Math.min(2e4,Math.random()*Math.pow(2,t)*e))},xn=function(e){return!!e&&(function(e){return void 0!==e.$retryable}(e)||function(e){return yn.includes(e.name)}(e)||En(e)||function(e){var t;return Sn.includes(e.name)||kn.includes((null===(t=e.$metadata)||void 0===t?void 0:t.httpStatusCode)||0)}(e))},Rn=function(){function t(e,t){var n,r,a;this.maxAttemptsProvider=e,this.mode=gn.STANDARD,this.retryDecider=null!==(n=null==t?void 0:t.retryDecider)&&void 0!==n?n:xn,this.delayDecider=null!==(r=null==t?void 0:t.delayDecider)&&void 0!==r?r:Tn,this.retryQuota=null!==(a=null==t?void 0:t.retryQuota)&&void 0!==a?a:function(e,t){var n,r,a,s=e,o=null!==(n=null==t?void 0:t.noRetryIncrement)&&void 0!==n?n:1,i=null!==(r=null==t?void 0:t.retryCost)&&void 0!==r?r:5,c=null!==(a=null==t?void 0:t.timeoutRetryCost)&&void 0!==a?a:10,u=e,l=function(e){return"TimeoutError"===e.name?c:i},d=function(e){return l(e)<=u};return Object.freeze({hasRetryTokens:d,retrieveRetryTokens:function(e){if(!d(e))throw new Error("No retry token available");var t=l(e);return u-=t,t},releaseRetryTokens:function(e){u+=null!=e?e:o,u=Math.min(u,s)}})}(500)}return t.prototype.shouldRetry=function(e,t,n){return t<n&&this.retryDecider(e)&&this.retryQuota.hasRetryTokens(e)},t.prototype.getMaxAttempts=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.maxAttemptsProvider()];case 1:return t=e.sent(),[3,3];case 2:return e.sent(),t=3,[3,3];case 3:return[2,t]}}))}))},t.prototype.retry=function(t,n,r){return e.__awaiter(this,void 0,void 0,(function(){var a,s,o,i,c,d,f,v;return e.__generator(this,(function(h){switch(h.label){case 0:return s=0,o=0,[4,this.getMaxAttempts()];case 1:i=h.sent(),c=n.request,u.HttpRequest.isInstance(c)&&(c.headers["amz-sdk-invocation-id"]=l.v4()),d=function(){var l,d,v,h,p,m;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,4,,7]),u.HttpRequest.isInstance(c)&&(c.headers["amz-sdk-request"]="attempt="+(s+1)+"; max="+i),(null==r?void 0:r.beforeRequest)?[4,r.beforeRequest()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,t(n)];case 3:return l=e.sent(),d=l.response,v=l.output,(null==r?void 0:r.afterRequest)&&r.afterRequest(d),f.retryQuota.releaseRetryTokens(a),v.$metadata.attempts=s+1,v.$metadata.totalRetryDelay=o,[2,{value:{response:d,output:v}}];case 4:return h=e.sent(),p=In(h),s++,f.shouldRetry(p,s,i)?(a=f.retryQuota.retrieveRetryTokens(p),m=f.delayDecider(En(p)?500:100,s),o+=m,[4,new Promise((function(e){return setTimeout(e,m)}))]):[3,6];case 5:return e.sent(),[2,"continue"];case 6:throw p.$metadata||(p.$metadata={}),p.$metadata.attempts=s,p.$metadata.totalRetryDelay=o,p;case 7:return[2]}}))},f=this,h.label=2;case 2:return[5,d()];case 3:return"object"==typeof(v=h.sent())?[2,v.value]:[3,2];case 4:return[2]}}))}))},t}(),In=function(e){return e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):"string"==typeof e?new Error(e):new Error("AWS SDK error wrapper for "+e)},Pn=function(){function t(e){var t,n,r,a,s;this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=null!==(t=null==e?void 0:e.beta)&&void 0!==t?t:.7,this.minCapacity=null!==(n=null==e?void 0:e.minCapacity)&&void 0!==n?n:1,this.minFillRate=null!==(r=null==e?void 0:e.minFillRate)&&void 0!==r?r:.5,this.scaleConstant=null!==(a=null==e?void 0:e.scaleConstant)&&void 0!==a?a:.4,this.smooth=null!==(s=null==e?void 0:e.smooth)&&void 0!==s?s:.8;var o=this.getCurrentTimeInSeconds();this.lastThrottleTime=o,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}return t.prototype.getCurrentTimeInSeconds=function(){return Date.now()/1e3},t.prototype.getSendToken=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,this.acquireTokenBucket(1)]}))}))},t.prototype.acquireTokenBucket=function(t){return e.__awaiter(this,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return this.enabled?(this.refillTokenBucket(),t>this.currentCapacity?(n=(t-this.currentCapacity)/this.fillRate*1e3,[4,new Promise((function(e){return setTimeout(e,n)}))]):[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return this.currentCapacity=this.currentCapacity-t,[2]}}))}))},t.prototype.refillTokenBucket=function(){var e=this.getCurrentTimeInSeconds();if(this.lastTimestamp){var t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}else this.lastTimestamp=e},t.prototype.updateClientSendingRate=function(e){var t;if(this.updateMeasuredRate(),En(e)){var n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());var r=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(r)},t.prototype.calculateTimeWindow=function(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))},t.prototype.cubicThrottle=function(e){return this.getPrecise(e*this.beta)},t.prototype.cubicSuccess=function(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)},t.prototype.enableTokenBucket=function(){this.enabled=!0},t.prototype.updateTokenBucketRate=function(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)},t.prototype.updateMeasuredRate=function(){var e=this.getCurrentTimeInSeconds(),t=Math.floor(2*e)/2;if(this.requestCount++,t>this.lastTxRateBucket){var n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}},t.prototype.getPrecise=function(e){return parseFloat(e.toFixed(8))},t}(),Cn=function(t){function n(n,r){var a=this,s=null!=r?r:{},o=s.rateLimiter,i=e.__rest(s,["rateLimiter"]);return(a=t.call(this,n,i)||this).rateLimiter=null!=o?o:new Pn,a.mode=gn.ADAPTIVE,a}return e.__extends(n,t),n.prototype.retry=function(n,r){return e.__awaiter(this,void 0,void 0,(function(){var a=this;return e.__generator(this,(function(s){return[2,t.prototype.retry.call(this,n,r,{beforeRequest:function(){return e.__awaiter(a,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,this.rateLimiter.getSendToken()]}))}))},afterRequest:function(e){a.rateLimiter.updateClientSendingRate(e)}})]}))}))},n}(Rn),zn={environmentVariableSelector:function(e){var t=e.AWS_MAX_ATTEMPTS;if(t){var n=parseInt(t);if(Number.isNaN(n))throw new Error('Environment variable AWS_MAX_ATTEMPTS mast be a number, got "'+t+'"');return n}},configFileSelector:function(e){var t=e.max_attempts;if(t){var n=parseInt(t);if(Number.isNaN(n))throw new Error('Shared config file entry max_attempts mast be a number, got "'+t+'"');return n}},default:3},On=function(t){var n=Ln(t.maxAttempts);return e.__assign(e.__assign({},t),{maxAttempts:n,retryStrategy:function(){return e.__awaiter(void 0,void 0,void 0,(function(){var r;return e.__generator(this,(function(e){switch(e.label){case 0:return t.retryStrategy?[2,t.retryStrategy]:(r=t.retryMode)?[3,2]:[4,t.retryModeProvider()];case 1:r=e.sent(),e.label=2;case 2:return r===gn.ADAPTIVE?[2,new Cn(n)]:[2,new Rn(n)]}}))}))}})},Ln=function(e){if(void 0===e&&(e=3),"number"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},Nn={environmentVariableSelector:function(e){return e.AWS_RETRY_MODE},configFileSelector:function(e){return e.retry_mode},default:An},Dn=function(t){return"function"==typeof t?function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,t()]}))}))}:(n=t,function(){return Promise.resolve(n)});var n},Un=function(t,n){var r,a=t.environmentVariableSelector,s=t.configFileSelector,o=t.default;return void 0===n&&(n={}),Te(Ae((r=a,function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){try{if(void 0===(t=r(process.env)))throw new Error;return[2,t]}catch(e){throw new Ee(e.message||"Cannot load config from environment variables with getter: "+r)}return[2]}))}))}),function(t,n){void 0===n&&(n={});var r=n.preferredFile,a=void 0===r?"config":r,s=e.__rest(n,["preferredFile"]);return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r,o,i,c,u,l,d,f,v,h;return e.__generator(this,(function(p){switch(p.label){case 0:return n=s.loadedConfig,r=void 0===n?Vt(s):n,o=s.profile,i=void 0===o?process.env.AWS_PROFILE||"default":o,[4,r];case 1:c=p.sent(),u=c.configFile,l=c.credentialsFile,d=l[i]||{},f=u[i]||{},v="config"===a?e.__assign(e.__assign({},d),f):e.__assign(e.__assign({},f),d);try{if(void 0===(h=t(v)))throw new Error;return[2,h]}catch(e){throw new Ee(e.message||"Cannot load config for profile "+i+" in SDK configuration files with getter: "+t)}return[2]}}))}))}}(s,n),Dn(o)))};var qn=["ECONNRESET","EPIPE","ETIMEDOUT"],jn=function(t){var n,r,a={};try{for(var s=e.__values(Object.keys(t)),o=s.next();!o.done;o=s.next()){var i=o.value,c=t[i];a[i]=Array.isArray(c)?c.join(","):c}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a};function Mn(e,t){t instanceof f.Readable?t.pipe(e):t?e.end(Buffer.from(t)):e.end()}var Kn=function(){function t(e){var t=void 0===e?{}:e,n=t.connectionTimeout,a=t.socketTimeout,s=t.httpAgent,o=t.httpsAgent;this.metadata={handlerProtocol:"http/1.1"},this.connectionTimeout=n,this.socketTimeout=a;this.httpAgent=s||new r.Agent({keepAlive:true,maxSockets:50}),this.httpsAgent=o||new d.Agent({keepAlive:true,maxSockets:50})}return t.prototype.destroy=function(){this.httpAgent.destroy(),this.httpsAgent.destroy()},t.prototype.handle=function(t,n){var a=this,s=(void 0===n?{}:n).abortSignal;return new Promise((function(n,o){if(null==s?void 0:s.aborted){var i=new Error("Request aborted");return i.name="AbortError",void o(i)}var c="https:"===t.protocol,l=function(t){var n,r,a=[];try{for(var s=e.__values(Object.keys(t).sort()),o=s.next();!o.done;o=s.next()){var i=o.value,c=t[i];if(i=Fe(i),Array.isArray(c))for(var u=0,l=c.length;u<l;u++)a.push(i+"="+Fe(c[u]));else{var d=i;(c||"string"==typeof c)&&(d+="="+Fe(c)),a.push(d)}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a.join("&")}(t.query||{}),f={headers:t.headers,host:t.hostname,method:t.method,path:l?t.path+"?"+l:t.path,port:t.port,agent:c?a.httpsAgent:a.httpAgent},v=(c?d.request:r.request)(f,(function(e){var t=new u.HttpResponse({statusCode:e.statusCode||-1,headers:jn(e.headers),body:e});n({response:t})}));v.on("error",(function(e){qn.includes(e.code)?o(Object.assign(e,{name:"TimeoutError"})):o(e)})),function(e,t,n){void 0===n&&(n=0),n&&e.on("socket",(function(r){if(r.connecting){var a=setTimeout((function(){e.destroy(),t(Object.assign(new Error("Socket timed out without establishing a connection within "+n+" ms"),{name:"TimeoutError"}))}),n);r.on("connect",(function(){clearTimeout(a)}))}}))}(v,o,a.connectionTimeout),function(e,t,n){void 0===n&&(n=0),e.setTimeout(n,(function(){e.destroy(),t(Object.assign(new Error("Connection timed out after "+n+" ms"),{name:"TimeoutError"}))}))}(v,o,a.socketTimeout),s&&(s.onabort=function(){v.abort();var e=new Error("Request aborted");e.name="AbortError",o(e)}),function(e,t){"100-continue"===(t.headers.Expect||t.headers.expect)?e.on("continue",(function(){Mn(e,t.body)})):Mn(e,t.body)}(v,t)}))},t}(),Wn=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.bufferedBytes=[],e}return e.__extends(n,t),n.prototype._write=function(e,t,n){this.bufferedBytes.push(e),n()},n}(f.Writable),$n=function(e){return new Promise((function(t,n){var r=new Wn;e.pipe(r),e.on("error",(function(e){r.end(),n(e)})),r.on("error",n),r.on("finish",(function(){var e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))}))};function Hn(e){var t=hn(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function Fn(e){return vn(e.buffer,e.byteOffset,e.byteLength).toString("base64")}function Vn(e){return e?"string"==typeof e?Buffer.from(e).length:"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:"string"==typeof e.path?a.lstatSync(e.path).size:void 0:0}var Bn=function(t){var n=t.serviceId,r=t.clientVersion,a=[["aws-sdk-js",r],["os/"+s.platform(),s.release()],["lang/js"],["md/nodejs",""+W.versions.node]];n&&a.push(["api/"+n,r]),W.env.AWS_EXECUTION_ENV&&a.push(["exec-env/"+W.env.AWS_EXECUTION_ENV]);var o=Un({environmentVariableSelector:function(e){return e.AWS_SDK_UA_APP_ID},configFileSelector:function(e){return e["sdk-ua-app-id"]},default:void 0})(),i=void 0;return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t;return e.__generator(this,(function(n){switch(n.label){case 0:return i?[3,2]:[4,o];case 1:t=n.sent(),i=t?e.__spreadArray(e.__spreadArray([],e.__read(a)),[["app/"+t]]):e.__spreadArray([],e.__read(a)),n.label=2;case 2:return[2,i]}}))}))}},Gn=function(e){var t=hn(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},Xn=function(e){return vn(e.buffer,e.byteOffset,e.byteLength).toString("utf8")},Yn=new Set(["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),Zn=new Set(["cn-north-1","cn-northwest-1"]),Jn=new Set(["us-iso-east-1"]),Qn=new Set(["us-isob-east-1"]),er=new Set(["us-gov-east-1","us-gov-west-1"]);var tr=function(t){var n,r=new URL(t),a=r.hostname,s=r.pathname,o=r.port,i=r.protocol,c=r.search;return c&&(n=function(t){var n,r,a={};if(t=t.replace(/^\?/,""))try{for(var s=e.__values(t.split("&")),o=s.next();!o.done;o=s.next()){var i=o.value,c=e.__read(i.split("="),2),u=c[0],l=c[1],d=void 0===l?null:l;u=decodeURIComponent(u),d&&(d=decodeURIComponent(d)),u in a?Array.isArray(a[u])?a[u].push(d):a[u]=[a[u],d]:a[u]=d}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a}(c)),{hostname:a,port:o?parseInt(o):void 0,protocol:i,path:s,query:n}},nr={apiVersion:"2019-06-10",disableHostPrefix:!1,logger:{},regionInfoProvider:function(t,n){var r=void 0;switch(t){case"ap-southeast-1":r={hostname:"portal.sso.ap-southeast-1.amazonaws.com",partition:"aws",signingRegion:"ap-southeast-1"};break;case"ap-southeast-2":r={hostname:"portal.sso.ap-southeast-2.amazonaws.com",partition:"aws",signingRegion:"ap-southeast-2"};break;case"ca-central-1":r={hostname:"portal.sso.ca-central-1.amazonaws.com",partition:"aws",signingRegion:"ca-central-1"};break;case"eu-central-1":r={hostname:"portal.sso.eu-central-1.amazonaws.com",partition:"aws",signingRegion:"eu-central-1"};break;case"eu-west-1":r={hostname:"portal.sso.eu-west-1.amazonaws.com",partition:"aws",signingRegion:"eu-west-1"};break;case"eu-west-2":r={hostname:"portal.sso.eu-west-2.amazonaws.com",partition:"aws",signingRegion:"eu-west-2"};break;case"us-east-1":r={hostname:"portal.sso.us-east-1.amazonaws.com",partition:"aws",signingRegion:"us-east-1"};break;case"us-east-2":r={hostname:"portal.sso.us-east-2.amazonaws.com",partition:"aws",signingRegion:"us-east-2"};break;case"us-west-2":r={hostname:"portal.sso.us-west-2.amazonaws.com",partition:"aws",signingRegion:"us-west-2"};break;default:Yn.has(t)&&(r={hostname:"portal.sso.{region}.amazonaws.com".replace("{region}",t),partition:"aws"}),Zn.has(t)&&(r={hostname:"portal.sso.{region}.amazonaws.com.cn".replace("{region}",t),partition:"aws-cn"}),Jn.has(t)&&(r={hostname:"portal.sso.{region}.c2s.ic.gov".replace("{region}",t),partition:"aws-iso"}),Qn.has(t)&&(r={hostname:"portal.sso.{region}.sc2s.sgov.gov".replace("{region}",t),partition:"aws-iso-b"}),er.has(t)&&(r={hostname:"portal.sso.{region}.amazonaws.com".replace("{region}",t),partition:"aws-us-gov"}),void 0===r&&(r={hostname:"portal.sso.{region}.amazonaws.com".replace("{region}",t),partition:"aws"})}return Promise.resolve(e.__assign({signingService:"awsssoportal"},r))},serviceId:"SSO",urlParser:tr},rr=e.__assign(e.__assign({},nr),{runtime:"node",base64Decoder:Hn,base64Encoder:Fn,bodyLengthChecker:Vn,defaultUserAgentProvider:Bn({serviceId:nr.serviceId,clientVersion:fn}),maxAttempts:Un(zn),region:Un(wt,yt),requestHandler:new Kn,retryModeProvider:Un(Nn),sha256:pn.bind(null,"sha256"),streamCollector:$n,utf8Decoder:Gn,utf8Encoder:Xn});var ar={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},sr=function(t){return{applyToStack:function(n){n.add(function(t){var n=this;return function(r){return function(a){return e.__awaiter(n,void 0,void 0,(function(){var n,s,o,i,c;return e.__generator(this,(function(l){return n=a.request,u.HttpRequest.isInstance(n)&&(s=n.body,o=n.headers,s&&-1===Object.keys(o).map((function(e){return e.toLowerCase()})).indexOf("content-length")&&void 0!==(i=t(s))&&(n.headers=e.__assign(e.__assign({},n.headers),((c={})["content-length"]=String(i),c)))),[2,r(e.__assign(e.__assign({},a),{request:n}))]}))}))}}}(t.bodyLengthChecker),ar)}}};var or={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},ir=function(t){return{applyToStack:function(n){n.add(function(t){return function(n){return function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var a,s;return e.__generator(this,(function(e){return u.HttpRequest.isInstance(r.request)?(a=r.request,(void 0===(s=(t.requestHandler.metadata||{}).handlerProtocol)?"":s).indexOf("h2")>=0&&!a.headers[":authority"]?(delete a.headers.host,a.headers[":authority"]=""):a.headers.host||(a.headers.host=a.hostname),[2,n(r)]):[2,n(r)]}))}))}}}(t),or)}}},cr={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},ur=function(t){return{applyToStack:function(t){t.add((function(t,n){return function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var a,s,o,i,c,u,l,d,f;return e.__generator(this,(function(v){switch(v.label){case 0:return a=n.clientName,s=n.commandName,o=n.inputFilterSensitiveLog,i=n.logger,c=n.outputFilterSensitiveLog,[4,t(r)];case 1:return u=v.sent(),i?("function"==typeof i.info&&(l=u.output,d=l.$metadata,f=e.__rest(l,["$metadata"]),i.info({clientName:a,commandName:s,input:o(r.input),output:c(f),metadata:d})),[2,u]):[2,u]}}))}))}}),cr)}}};function lr(t){return e.__assign(e.__assign({},t),{customUserAgent:"string"==typeof t.customUserAgent?[[t.customUserAgent]]:t.customUserAgent})}var dr,fr,vr,hr,pr,mr,gr,_r,wr,yr,br,Sr,kr,Er,Ar=/[^\!\#\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Tr=function(t){var n=e.__read(t,2),r=n[0],a=n[1],s=r.indexOf("/"),o=r.substring(0,s),i=r.substring(s+1);return"api"===o&&(i=i.toLowerCase()),[o,i,a].filter((function(e){return e&&e.length>0})).map((function(e){return null==e?void 0:e.replace(Ar,"_")})).join("/")},xr={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},Rr=function(t){return{applyToStack:function(n){var r;n.add((r=t,function(t,n){return function(a){return e.__awaiter(void 0,void 0,void 0,(function(){var s,o,i,c,l,d,f,v,h;return e.__generator(this,(function(p){switch(p.label){case 0:return s=a.request,u.HttpRequest.isInstance(s)?(o=s.headers,i=(null===(v=null==n?void 0:n.userAgent)||void 0===v?void 0:v.map(Tr))||[],[4,r.defaultUserAgentProvider()]):[2,t(a)];case 1:return c=p.sent().map(Tr),l=(null===(h=null==r?void 0:r.customUserAgent)||void 0===h?void 0:h.map(Tr))||[],d=e.__spreadArray(e.__spreadArray(e.__spreadArray([],e.__read(c)),e.__read(i)),e.__read(l)).join(" "),f=e.__spreadArray(e.__spreadArray([],e.__read(c.filter((function(e){return e.startsWith("aws-sdk-")})))),e.__read(l)).join(" "),"browser"!==r.runtime?(f&&(o["x-amz-user-agent"]=o["x-amz-user-agent"]?o["user-agent"]+" "+f:f),o["user-agent"]=d):o["x-amz-user-agent"]=d,[2,t(e.__assign(e.__assign({},a),{request:s}))]}}))}))}}),xr)}}},Ir=function(t){function n(n){var r=this,a=e.__assign(e.__assign({},rr),n),s=bt(a),o=mt(s),i=lr(On(o));return(r=t.call(this,i)||this).config=i,r.middlewareStack.use(wn(r.config)),r.middlewareStack.use(sr(r.config)),r.middlewareStack.use(ir(r.config)),r.middlewareStack.use(ur(r.config)),r.middlewareStack.use(Rr(r.config)),r}return e.__extends(n,t),n.prototype.destroy=function(){t.prototype.destroy.call(this)},n}(u.Client);!function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(dr||(dr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:u.SENSITIVE_STRING})}}(fr||(fr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign(e.__assign({},t),t.secretAccessKey&&{secretAccessKey:u.SENSITIVE_STRING}),t.sessionToken&&{sessionToken:u.SENSITIVE_STRING})}}(vr||(vr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.roleCredentials&&{roleCredentials:vr.filterSensitiveLog(t.roleCredentials)})}}(hr||(hr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(pr||(pr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(mr||(mr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(gr||(gr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(_r||(_r={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:u.SENSITIVE_STRING})}}(wr||(wr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(yr||(yr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(br||(br={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:u.SENSITIVE_STRING})}}(Sr||(Sr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(kr||(kr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:u.SENSITIVE_STRING})}}(Er||(Er={}));var Pr,Cr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s,o,i,c,u,l,d,f,v;return e.__generator(this,(function(h){switch(h.label){case 0:return a=[e.__assign({},t)],v={},[4,Mr(t.body,n)];case 1:switch(r=e.__assign.apply(void 0,a.concat([(v.body=h.sent(),v)])),o="UnknownError",o=Kr(t,r.body),o){case"InvalidRequestException":case"com.amazonaws.sso#InvalidRequestException":return[3,2];case"ResourceNotFoundException":case"com.amazonaws.sso#ResourceNotFoundException":return[3,4];case"TooManyRequestsException":case"com.amazonaws.sso#TooManyRequestsException":return[3,6];case"UnauthorizedException":case"com.amazonaws.sso#UnauthorizedException":return[3,8]}return[3,10];case 2:return i=[{}],[4,zr(r)];case 3:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,i.concat([h.sent()])),{name:o,$metadata:Ur(t)}]),[3,11];case 4:return c=[{}],[4,Or(r)];case 5:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,c.concat([h.sent()])),{name:o,$metadata:Ur(t)}]),[3,11];case 6:return u=[{}],[4,Lr(r)];case 7:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,u.concat([h.sent()])),{name:o,$metadata:Ur(t)}]),[3,11];case 8:return l=[{}],[4,Nr(r)];case 9:return s=e.__assign.apply(void 0,[e.__assign.apply(void 0,l.concat([h.sent()])),{name:o,$metadata:Ur(t)}]),[3,11];case 10:d=r.body,o=d.code||d.Code||o,s=e.__assign(e.__assign({},d),{name:""+o,message:d.message||d.Message||o,$fault:"client",$metadata:Ur(t)}),h.label=11;case 11:return f=s.message||s.Message||o,s.message=f,delete s.Message,[2,Promise.reject(Object.assign(new Error(f),s))]}}))}))},zr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(e){return n={name:"InvalidRequestException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=r.message),[2,n]}))}))},Or=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(e){return n={name:"ResourceNotFoundException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=r.message),[2,n]}))}))},Lr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(e){return n={name:"TooManyRequestsException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=r.message),[2,n]}))}))},Nr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(e){return n={name:"UnauthorizedException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=r.message),[2,n]}))}))},Dr=function(e,t){return{accessKeyId:void 0!==e.accessKeyId&&null!==e.accessKeyId?e.accessKeyId:void 0,expiration:void 0!==e.expiration&&null!==e.expiration?e.expiration:void 0,secretAccessKey:void 0!==e.secretAccessKey&&null!==e.secretAccessKey?e.secretAccessKey:void 0,sessionToken:void 0!==e.sessionToken&&null!==e.sessionToken?e.sessionToken:void 0}},Ur=function(e){var t;return{httpStatusCode:e.statusCode,requestId:null!==(t=e.headers["x-amzn-requestid"])&&void 0!==t?t:e.headers["x-amzn-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},qr=function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then((function(e){return t.utf8Encoder(e)}))},jr=function(e){return!(null==e||""===e||Object.getOwnPropertyNames(e).includes("length")&&0==e.length||Object.getOwnPropertyNames(e).includes("size")&&0==e.size)},Mr=function(e,t){return qr(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},Kr=function(e,t){var n,r,a=function(e){var t=e;return t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},s=(n=e.headers,r="x-amzn-errortype",Object.keys(n).find((function(e){return e.toLowerCase()===r.toLowerCase()})));return void 0!==s?a(e.headers[s]):void 0!==t.code?a(t.code):void 0!==t.__type?a(t.__type):""},Wr=function(t){function n(e){var n=t.call(this)||this;return n.input=e,n}return e.__extends(n,t),n.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(u.getSerdePlugin(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),a={logger:t.logger,clientName:"SSOClient",commandName:"GetRoleCredentialsCommand",inputFilterSensitiveLog:fr.filterSensitiveLog,outputFilterSensitiveLog:hr.filterSensitiveLog},s=t.requestHandler;return r.resolve((function(e){return s.handle(e.request,n||{})}),a)},n.prototype.serialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a,s,o,i,c,l,d;return e.__generator(this,(function(f){switch(f.label){case 0:return r=e.__assign({},jr(t.accessToken)&&{"x-amz-sso_bearer_token":t.accessToken}),a="/federation/credentials",s=e.__assign(e.__assign({},void 0!==t.roleName&&{role_name:t.roleName}),void 0!==t.accountId&&{account_id:t.accountId}),[4,n.endpoint()];case 1:return o=f.sent(),i=o.hostname,c=o.protocol,l=void 0===c?"https":c,d=o.port,[2,new u.HttpRequest({protocol:l,hostname:i,port:d,method:"GET",headers:r,path:a,query:s,body:void 0})]}}))}))}(t,n)},n.prototype.deserialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,a;return e.__generator(this,(function(e){switch(e.label){case 0:return 200!==t.statusCode&&t.statusCode>=300?[2,Cr(t,n)]:(r={$metadata:Ur(t),roleCredentials:void 0},[4,Mr(t.body,n)]);case 1:return void 0!==(a=e.sent()).roleCredentials&&null!==a.roleCredentials&&(r.roleCredentials=Dr(a.roleCredentials)),[2,Promise.resolve(r)]}}))}))}(t,n)},n}(u.Command),$r=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,nn(t)];case 1:return n=e.sent(),[2,Hr(rn(t),n,t)]}}))}))}},Hr=function(t,n,r){return e.__awaiter(void 0,void 0,void 0,(function(){var s,i,u,l,d,f,v,h,p,m,g,_,w,y,b,S,k,E,A;return e.__generator(this,(function(e){switch(e.label){case 0:if(!(s=n[t]))throw new Ee("Profile "+t+" could not be found in shared credentials file.");if(i=s.sso_start_url,u=s.sso_account_id,l=s.sso_region,d=s.sso_role_name,!(i||u||l||d))throw new Ee("Profile "+t+" is not configured with SSO credentials.");if(!(i&&u&&l&&d))throw new Ee("Profile "+t+' does not have valid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html',false);f=c.createHash("sha1"),v=f.update(i).digest("hex"),h=o.join(Jt(),".aws","sso","cache",v+".json");try{if(p=JSON.parse(a.readFileSync(h,{encoding:"utf-8"})),new Date(p.expiresAt).getTime()-Date.now()<=9e5)throw new Error("SSO token is expired.")}catch(e){throw new Ee("The SSO session associated with this profile has expired or is otherwise invalid. To refresh this SSO session run aws sso login with the corresponding profile.",false)}m=p.accessToken,g=r.ssoClient||new Ir({region:l}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,g.send(new Wr({accountId:u,roleName:d,accessToken:m}))];case 2:return _=e.sent(),[3,4];case 3:throw w=e.sent(),Ee.from(w,false);case 4:if(y=_.roleCredentials,S=(b=void 0===y?{}:y).accessKeyId,k=b.secretAccessKey,E=b.sessionToken,A=b.expiration,!(S&&k&&E&&A))throw new Ee("SSO returns an invalid temporary credential.",false);return[2,{accessKeyId:S,secretAccessKey:k,sessionToken:E,expiration:new Date(A)}]}}))}))},Fr=function(t){void 0===t&&(t={});var n=e.__assign({profile:process.env.AWS_PROFILE},t);n.loadedConfig||(n.loadedConfig=Vt(t));var r=[$r(n),tn(n),un(n),$t(n),Vr(n)];n.profile||r.unshift(kt());var a=Ae.apply(void 0,e.__spreadArray([],e.__read(r)));return Te(a,(function(e){return void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5}),(function(e){return void 0!==e.expiration}))},Vr=function(e){return process.env[Pt]||process.env[It]?Ct(e):process.env.AWS_EC2_METADATA_DISABLED?function(){return Promise.reject(new Ee("EC2 Instance Metadata Service access disabled"))}:qt(e)},Br=new Set(["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),Gr=new Set(["cn-north-1","cn-northwest-1"]),Xr=new Set(["us-iso-east-1"]),Yr=new Set(["us-isob-east-1"]),Zr=new Set(["us-gov-east-1","us-gov-west-1"]),Jr={apiVersion:"2011-06-15",disableHostPrefix:!1,logger:{},regionInfoProvider:function(t,n){var r=void 0;switch(t){case"af-south-1":r={hostname:"sts.af-south-1.amazonaws.com",partition:"aws"};break;case"ap-east-1":r={hostname:"sts.ap-east-1.amazonaws.com",partition:"aws"};break;case"ap-northeast-1":r={hostname:"sts.ap-northeast-1.amazonaws.com",partition:"aws"};break;case"ap-northeast-2":r={hostname:"sts.ap-northeast-2.amazonaws.com",partition:"aws"};break;case"ap-northeast-3":r={hostname:"sts.ap-northeast-3.amazonaws.com",partition:"aws"};break;case"ap-south-1":r={hostname:"sts.ap-south-1.amazonaws.com",partition:"aws"};break;case"ap-southeast-1":r={hostname:"sts.ap-southeast-1.amazonaws.com",partition:"aws"};break;case"ap-southeast-2":r={hostname:"sts.ap-southeast-2.amazonaws.com",partition:"aws"};break;case"aws-global":r={hostname:"sts.amazonaws.com",partition:"aws",signingRegion:"us-east-1"};break;case"ca-central-1":r={hostname:"sts.ca-central-1.amazonaws.com",partition:"aws"};break;case"cn-north-1":r={hostname:"sts.cn-north-1.amazonaws.com.cn",partition:"aws-cn"};break;case"cn-northwest-1":r={hostname:"sts.cn-northwest-1.amazonaws.com.cn",partition:"aws-cn"};break;case"eu-central-1":r={hostname:"sts.eu-central-1.amazonaws.com",partition:"aws"};break;case"eu-north-1":r={hostname:"sts.eu-north-1.amazonaws.com",partition:"aws"};break;case"eu-south-1":r={hostname:"sts.eu-south-1.amazonaws.com",partition:"aws"};break;case"eu-west-1":r={hostname:"sts.eu-west-1.amazonaws.com",partition:"aws"};break;case"eu-west-2":r={hostname:"sts.eu-west-2.amazonaws.com",partition:"aws"};break;case"eu-west-3":r={hostname:"sts.eu-west-3.amazonaws.com",partition:"aws"};break;case"me-south-1":r={hostname:"sts.me-south-1.amazonaws.com",partition:"aws"};break;case"sa-east-1":r={hostname:"sts.sa-east-1.amazonaws.com",partition:"aws"};break;case"us-east-1":r={hostname:"sts.us-east-1.amazonaws.com",partition:"aws"};break;case"us-east-1-fips":r={hostname:"sts-fips.us-east-1.amazonaws.com",partition:"aws",signingRegion:"us-east-1"};break;case"us-east-2":r={hostname:"sts.us-east-2.amazonaws.com",partition:"aws"};break;case"us-east-2-fips":r={hostname:"sts-fips.us-east-2.amazonaws.com",partition:"aws",signingRegion:"us-east-2"};break;case"us-gov-east-1":r={hostname:"sts.us-gov-east-1.amazonaws.com",partition:"aws-us-gov"};break;case"us-gov-east-1-fips":r={hostname:"sts.us-gov-east-1.amazonaws.com",partition:"aws-us-gov",signingRegion:"us-gov-east-1"};break;case"us-gov-west-1":r={hostname:"sts.us-gov-west-1.amazonaws.com",partition:"aws-us-gov"};break;case"us-gov-west-1-fips":r={hostname:"sts.us-gov-west-1.amazonaws.com",partition:"aws-us-gov",signingRegion:"us-gov-west-1"};break;case"us-iso-east-1":r={hostname:"sts.us-iso-east-1.c2s.ic.gov",partition:"aws-iso"};break;case"us-isob-east-1":r={hostname:"sts.us-isob-east-1.sc2s.sgov.gov",partition:"aws-iso-b"};break;case"us-west-1":r={hostname:"sts.us-west-1.amazonaws.com",partition:"aws"};break;case"us-west-1-fips":r={hostname:"sts-fips.us-west-1.amazonaws.com",partition:"aws",signingRegion:"us-west-1"};break;case"us-west-2":r={hostname:"sts.us-west-2.amazonaws.com",partition:"aws"};break;case"us-west-2-fips":r={hostname:"sts-fips.us-west-2.amazonaws.com",partition:"aws",signingRegion:"us-west-2"};break;default:Br.has(t)&&(r={hostname:"sts.{region}.amazonaws.com".replace("{region}",t),partition:"aws"}),Gr.has(t)&&(r={hostname:"sts.{region}.amazonaws.com.cn".replace("{region}",t),partition:"aws-cn"}),Xr.has(t)&&(r={hostname:"sts.{region}.c2s.ic.gov".replace("{region}",t),partition:"aws-iso"}),Yr.has(t)&&(r={hostname:"sts.{region}.sc2s.sgov.gov".replace("{region}",t),partition:"aws-iso-b"}),Zr.has(t)&&(r={hostname:"sts.{region}.amazonaws.com".replace("{region}",t),partition:"aws-us-gov"}),void 0===r&&(r={hostname:"sts.{region}.amazonaws.com".replace("{region}",t),partition:"aws"})}return Promise.resolve(e.__assign({signingService:"sts"},r))},serviceId:"STS",urlParser:tr},Qr=e.__assign(e.__assign({},Jr),{runtime:"node",base64Decoder:Hn,base64Encoder:Fn,bodyLengthChecker:Vn,credentialDefaultProvider:(Pr=Fr,function(t){return Pr(e.__assign({roleAssumer:ht(t,t.stsClientCtor),roleAssumerWithWebIdentity:pt(t,t.stsClientCtor)},t))}),defaultUserAgentProvider:Bn({serviceId:Jr.serviceId,clientVersion:H}),maxAttempts:Un(zn),region:Un(wt,yt),requestHandler:new Kn,retryModeProvider:Un(Nn),sha256:pn.bind(null,"sha256"),streamCollector:$n,utf8Decoder:Gn,utf8Encoder:Xn}),ea=function(t){function n(r){var a,s,o=this,i=e.__assign(e.__assign({},Qr),r),c=bt(i),u=mt(c),l=On(u),d=lr((a=l,s=n,at(e.__assign(e.__assign({},a),{stsClientCtor:s}))));return(o=t.call(this,d)||this).config=d,o.middlewareStack.use(wn(o.config)),o.middlewareStack.use(sr(o.config)),o.middlewareStack.use(ir(o.config)),o.middlewareStack.use(ur(o.config)),o.middlewareStack.use(Rr(o.config)),o}return e.__extends(n,t),n.prototype.destroy=function(){t.prototype.destroy.call(this)},n}(u.Client),ta=function(e){return void 0===e&&(e={}),pt(e,ea)},na=function(e,t){return(na=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var ra=function(){return(ra=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function aa(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function sa(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(a)throw a.error}}return o}function oa(e){return this instanceof oa?(this.v=e,this):new oa(e)}for(var ia=Object.freeze({__proto__:null,__extends:function(e,t){function n(){this.constructor=e}na(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},get __assign(){return ra},__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},__decorate:function(e,t,n,r){var a,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(o=(s<3?a(o):s>3?a(t,n,o):a(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},__param:function(e,t){return function(n,r){t(n,r,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function i(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((r=r.apply(e,t||[])).next())}))},__generator:function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},__createBinding:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},__exportStar:function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},__values:aa,__read:sa,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(sa(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,i=s.length;o<i;o++,a++)r[a]=s[o];return r},__await:oa,__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){a[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||i(e,t)}))})}function i(e,t){try{(n=a[e](t)).value instanceof oa?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){i("next",e)}function u(e){i("throw",e)}function l(e,t){e(t),s.shift(),s.length&&i(s[0][0],s[0][1])}},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(n=!n)?{value:oa(e[r](t)),done:"return"===r}:a?a(t):t}:a}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=aa(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,a){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,a,(t=e[n](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}}),ca=u.getAugmentedNamespace(ia),ua=u.createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Crc32=t.crc32=void 0,t.crc32=function(e){return(new n).update(e).digest()};var n=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,n;try{for(var a=ca.__values(e),s=a.next();!s.done;s=a.next()){var o=s.value;this.checksum=this.checksum>>>8^r[255&(this.checksum^o)]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();t.Crc32=n;var r=Uint32Array.from([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117])})),la={},da={},fa=0;fa<256;fa++){var va=fa.toString(16).toLowerCase();1===va.length&&(va="0"+va),la[fa]=va,da[va]=fa}function ha(e){for(var t="",n=0;n<e.byteLength;n++)t+=la[e[n]];return t}var pa=function(){function e(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}return e.fromNumber=function(t){if(t>0x8000000000000000||t<-0x8000000000000000)throw new Error(t+" is too large (or, if negative, too small) to represent as an Int64");for(var n=new Uint8Array(8),r=7,a=Math.abs(Math.round(t));r>-1&&a>0;r--,a/=256)n[r]=a;return t<0&&ma(n),new e(n)},e.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&ma(e),parseInt(ha(e),16)*(t?-1:1)},e.prototype.toString=function(){return String(this.valueOf())},e}();function ma(e){for(var t=0;t<8;t++)e[t]^=255;for(t=7;t>-1&&(e[t]++,0===e[t]);t--);}var ga,_a=function(){function t(e,t){this.toUtf8=e,this.fromUtf8=t}return t.prototype.format=function(t){var n,r,a,s,o=[];try{for(var i=e.__values(Object.keys(t)),c=i.next();!c.done;c=i.next()){var u=c.value,l=this.fromUtf8(u);o.push(Uint8Array.from([l.byteLength]),l,this.formatHeaderValue(t[u]))}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}var d=new Uint8Array(o.reduce((function(e,t){return e+t.byteLength}),0)),f=0;try{for(var v=e.__values(o),h=v.next();!h.done;h=v.next()){var p=h.value;d.set(p,f),f+=p.byteLength}}catch(e){a={error:e}}finally{try{h&&!h.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}return d},t.prototype.formatHeaderValue=function(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":var t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":var n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":var r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":var a=new DataView(new ArrayBuffer(3+e.value.byteLength));a.setUint8(0,6),a.setUint16(1,e.value.byteLength,!1);var s=new Uint8Array(a.buffer);return s.set(e.value,3),s;case"string":var o=this.fromUtf8(e.value),i=new DataView(new ArrayBuffer(3+o.byteLength));i.setUint8(0,7),i.setUint16(1,o.byteLength,!1);var c=new Uint8Array(i.buffer);return c.set(o,3),c;case"timestamp":var u=new Uint8Array(9);return u[0]=8,u.set(pa.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!Ra.test(e.value))throw new Error("Invalid UUID received: "+e.value);var l=new Uint8Array(17);return l[0]=9,l.set(function(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2){var r=e.substr(n,2).toLowerCase();if(!(r in da))throw new Error("Cannot decode unrecognized sequence "+r+" as hexadecimal");t[n/2]=da[r]}return t}(e.value.replace(/\-/g,"")),1),l}},t.prototype.parse=function(e){for(var t={},n=0;n<e.byteLength;){var r=e.getUint8(n++),a=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,r));switch(n+=r,e.getUint8(n++)){case 0:t[a]={type:wa,value:!0};break;case 1:t[a]={type:wa,value:!1};break;case 2:t[a]={type:ya,value:e.getInt8(n++)};break;case 3:t[a]={type:ba,value:e.getInt16(n,!1)},n+=2;break;case 4:t[a]={type:Sa,value:e.getInt32(n,!1)},n+=4;break;case 5:t[a]={type:ka,value:new pa(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:var s=e.getUint16(n,!1);n+=2,t[a]={type:Ea,value:new Uint8Array(e.buffer,e.byteOffset+n,s)},n+=s;break;case 7:var o=e.getUint16(n,!1);n+=2,t[a]={type:Aa,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,o))},n+=o;break;case 8:t[a]={type:Ta,value:new Date(new pa(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:var i=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,t[a]={type:xa,value:ha(i.subarray(0,4))+"-"+ha(i.subarray(4,6))+"-"+ha(i.subarray(6,8))+"-"+ha(i.subarray(8,10))+"-"+ha(i.subarray(10))};break;default:throw new Error("Unrecognized header type tag")}}return t},t}();!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(ga||(ga={}));var wa="boolean",ya="byte",ba="short",Sa="integer",ka="long",Ea="binary",Aa="string",Ta="timestamp",xa="uuid",Ra=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;var Ia=function(){function e(e,t){this.headerMarshaller=new _a(e,t)}return e.prototype.marshall=function(e){var t=e.headers,n=e.body,r=this.headerMarshaller.format(t),a=r.byteLength+n.byteLength+16,s=new Uint8Array(a),o=new DataView(s.buffer,s.byteOffset,s.byteLength),i=new ua.Crc32;return o.setUint32(0,a,!1),o.setUint32(4,r.byteLength,!1),o.setUint32(8,i.update(s.subarray(0,8)).digest(),!1),s.set(r,12),s.set(n,r.byteLength+12),o.setUint32(a-4,i.update(s.subarray(8,a-4)).digest(),!1),s},e.prototype.unmarshall=function(e){var t=function(e){var t=e.byteLength,n=e.byteOffset,r=e.buffer;if(t<16)throw new Error("Provided message too short to accommodate event stream message overhead");var a=new DataView(r,n,t),s=a.getUint32(0,!1);if(t!==s)throw new Error("Reported message length does not match received message length");var o=a.getUint32(4,!1),i=a.getUint32(8,!1),c=a.getUint32(t-4,!1),u=(new ua.Crc32).update(new Uint8Array(r,n,8));if(i!==u.digest())throw new Error("The prelude checksum specified in the message ("+i+") does not match the calculated CRC32 checksum ("+u.digest()+")");if(u.update(new Uint8Array(r,n+8,t-12)),c!==u.digest())throw new Error("The message checksum ("+u.digest()+") did not match the expected value of "+c);return{headers:new DataView(r,n+8+4,o),body:new Uint8Array(r,n+8+4+o,s-o-16)}}(e),n=t.headers,r=t.body;return{headers:this.headerMarshaller.parse(n),body:r}},e.prototype.formatHeaders=function(e){return this.headerMarshaller.format(e)},e}();var Pa=function(){function t(e){var t=e.utf8Encoder,n=e.utf8Decoder;this.eventMarshaller=new Ia(t,n),this.utfEncoder=t}return t.prototype.deserialize=function(t,n){var r,a,s,o,i,c,u;return function(t,n){var r;return(r={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var r,a,s,o,i,c,u,l,d,f,v,h,p,m,g,_,w;return e.__generator(this,(function(y){switch(y.label){case 0:y.trys.push([0,12,13,18]),r=e.__asyncValues(t),y.label=1;case 1:return[4,e.__await(r.next())];case 2:if((a=y.sent()).done)return[3,11];if(s=a.value,o=n.eventMarshaller.unmarshall(s),"error"!==(i=o.headers[":message-type"].value))return[3,3];throw(c=new Error(o.headers[":error-message"].value||"UnknownError")).name=o.headers[":error-code"].value,c;case 3:return"exception"!==i?[3,5]:(u=o.headers[":exception-type"].value,(m={})[u]=o,l=m,[4,e.__await(n.deserializer(l))]);case 4:if((d=y.sent()).$unknown)throw(f=new Error(n.toUtf8(o.body))).name=u,f;throw d[u];case 5:return"event"!==i?[3,9]:((g={})[o.headers[":event-type"].value]=o,v=g,[4,e.__await(n.deserializer(v))]);case 6:return(h=y.sent()).$unknown?[3,10]:[4,e.__await(h)];case 7:return[4,y.sent()];case 8:return y.sent(),[3,10];case 9:throw Error("Unrecognizable event type: "+o.headers[":event-type"].value);case 10:return[3,1];case 11:return[3,18];case 12:return p=y.sent(),_={error:p},[3,18];case 13:return y.trys.push([13,,16,17]),a&&!a.done&&(w=r.return)?[4,e.__await(w.call(r))]:[3,15];case 14:y.sent(),y.label=15;case 15:return[3,17];case 16:if(_)throw _.error;return[7];case 17:return[7];case 18:return[2]}}))}))},r}((r=t,s=0,o=0,i=null,c=null,u=function(e){if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);s=e,o=4,i=new Uint8Array(e),new DataView(i.buffer).setUint32(0,e,!1)},(a={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var t,n,a,l,d,f,v,h;return e.__generator(this,(function(p){switch(p.label){case 0:t=r[Symbol.asyncIterator](),p.label=1;case 1:return[4,e.__await(t.next())];case 2:return n=p.sent(),a=n.value,n.done?s?[3,4]:[4,e.__await(void 0)]:[3,10];case 3:return[2,p.sent()];case 4:return s!==o?[3,7]:[4,e.__await(i)];case 5:return[4,p.sent()];case 6:return p.sent(),[3,8];case 7:throw new Error("Truncated event message received.");case 8:return[4,e.__await(void 0)];case 9:return[2,p.sent()];case 10:l=a.length,d=0,p.label=11;case 11:if(!(d<l))return[3,15];if(!i){if(f=l-d,c||(c=new Uint8Array(4)),v=Math.min(4-o,f),c.set(a.slice(d,d+v),o),d+=v,(o+=v)<4)return[3,15];u(new DataView(c.buffer).getUint32(0,!1)),c=null}return h=Math.min(s-o,l-d),i.set(a.slice(d,d+h),o),o+=h,d+=h,s&&s===o?[4,e.__await(i)]:[3,14];case 12:return[4,p.sent()];case 13:p.sent(),i=null,s=0,o=0,p.label=14;case 14:return[3,11];case 15:return[3,1];case 16:return[2]}}))}))},a),{eventMarshaller:this.eventMarshaller,deserializer:n,toUtf8:this.utfEncoder})},t.prototype.serialize=function(t,n){var r,a=this;return(r={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var r,s,o,i,c,u,l;return e.__generator(this,(function(d){switch(d.label){case 0:d.trys.push([0,7,8,13]),r=e.__asyncValues(t),d.label=1;case 1:return[4,e.__await(r.next())];case 2:return(s=d.sent()).done?[3,6]:(o=s.value,i=a.eventMarshaller.marshall(n(o)),[4,e.__await(i)]);case 3:return[4,d.sent()];case 4:d.sent(),d.label=5;case 5:return[3,1];case 6:return[3,13];case 7:return c=d.sent(),u={error:c},[3,13];case 8:return d.trys.push([8,,11,12]),s&&!s.done&&(l=r.return)?[4,e.__await(l.call(r))]:[3,10];case 9:d.sent(),d.label=10;case 10:return[3,12];case 11:if(u)throw u.error;return[7];case 12:return[7];case 13:return[4,e.__await(new Uint8Array(0))];case 14:return[4,d.sent()];case 15:return d.sent(),[2]}}))}))},r},t}();var Ca=function(){function t(e){var t=e.utf8Encoder,n=e.utf8Decoder;this.eventMarshaller=new Ia(t,n),this.universalMarshaller=new Pa({utf8Decoder:n,utf8Encoder:t})}return t.prototype.deserialize=function(t,n){var r="function"==typeof t[Symbol.asyncIterator]?t:function(t){return e.__asyncGenerator(this,arguments,(function(){var n,r,a,s;return e.__generator(this,(function(o){switch(o.label){case 0:n=!1,r=!1,a=new Array,t.on("error",(function(e){if(n||(n=!0),e)throw e})),t.on("data",(function(e){a.push(e)})),t.on("end",(function(){n=!0})),o.label=1;case 1:return r?[3,6]:[4,e.__await(new Promise((function(e){return setTimeout((function(){return e(a.shift())}),0)})))];case 2:return(s=o.sent())?[4,e.__await(s)]:[3,5];case 3:return[4,o.sent()];case 4:o.sent(),o.label=5;case 5:return r=n&&0===a.length,[3,1];case 6:return[2]}}))}))}(t);return this.universalMarshaller.deserialize(r,n)},t.prototype.serialize=function(t,n){var r=this.universalMarshaller.serialize(t,n);if("function"==typeof f.Readable.from)return f.Readable.from(r);var a=r[Symbol.asyncIterator](),s=new f.Readable({autoDestroy:!0,objectMode:!0,read:function(){return e.__awaiter(this,void 0,void 0,(function(){var t=this;return e.__generator(this,(function(e){return a.next().then((function(e){var n=e.done,r=e.value;n?t.push(null):t.push(r)})).catch((function(e){t.destroy(e)})),[2]}))}))}});return s.on("error",(function(){s.destroy()})),s.on("end",(function(){s.destroy()})),s},t}(),za=function(t){function n(e,n){var r=t.call(this,n)||this;return r.hash=e,r}return e.__extends(n,t),n.prototype._write=function(e,t,n){try{this.hash.update(e)}catch(e){return n(e)}n()},n}(f.Writable);var Oa={environmentVariableSelector:function(e){if(Object.prototype.hasOwnProperty.call(e,"AWS_S3_USE_ARN_REGION")){if("true"===e.AWS_S3_USE_ARN_REGION)return!0;if("false"===e.AWS_S3_USE_ARN_REGION)return!1;throw new Error('Cannot load env AWS_S3_USE_ARN_REGION. Expected "true" or "false", got '+e.AWS_S3_USE_ARN_REGION+".")}},configFileSelector:function(e){if(Object.prototype.hasOwnProperty.call(e,"s3_use_arn_region")){if("true"===e.s3_use_arn_region)return!0;if("false"===e.s3_use_arn_region)return!1;throw new Error('Cannot load shared config entry s3_use_arn_region. Expected "true" or "false", got '+e.s3_use_arn_region+".")}},default:!1};const La=new Set(["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),Na=new Set(["cn-north-1","cn-northwest-1"]),Da=new Set(["us-iso-east-1"]),Ua=new Set(["us-isob-east-1"]),qa=new Set(["us-gov-east-1","us-gov-west-1"]),ja={apiVersion:"2006-03-01",disableHostPrefix:!1,logger:{},regionInfoProvider:(e,t)=>{let n;switch(e){case"accesspoint-af-south-1":n={hostname:"s3-accesspoint.af-south-1.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-east-1":n={hostname:"s3-accesspoint.ap-east-1.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-northeast-1":n={hostname:"s3-accesspoint.ap-northeast-1.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-northeast-2":n={hostname:"s3-accesspoint.ap-northeast-2.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-northeast-3":n={hostname:"s3-accesspoint.ap-northeast-3.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-south-1":n={hostname:"s3-accesspoint.ap-south-1.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-southeast-1":n={hostname:"s3-accesspoint.ap-southeast-1.amazonaws.com",partition:"aws"};break;case"accesspoint-ap-southeast-2":n={hostname:"s3-accesspoint.ap-southeast-2.amazonaws.com",partition:"aws"};break;case"accesspoint-ca-central-1":n={hostname:"s3-accesspoint.ca-central-1.amazonaws.com",partition:"aws"};break;case"accesspoint-cn-north-1":n={hostname:"s3-accesspoint.cn-north-1.amazonaws.com.cn",partition:"aws-cn"};break;case"accesspoint-cn-northwest-1":n={hostname:"s3-accesspoint.cn-northwest-1.amazonaws.com.cn",partition:"aws-cn"};break;case"accesspoint-eu-central-1":n={hostname:"s3-accesspoint.eu-central-1.amazonaws.com",partition:"aws"};break;case"accesspoint-eu-north-1":n={hostname:"s3-accesspoint.eu-north-1.amazonaws.com",partition:"aws"};break;case"accesspoint-eu-south-1":n={hostname:"s3-accesspoint.eu-south-1.amazonaws.com",partition:"aws"};break;case"accesspoint-eu-west-1":n={hostname:"s3-accesspoint.eu-west-1.amazonaws.com",partition:"aws"};break;case"accesspoint-eu-west-2":n={hostname:"s3-accesspoint.eu-west-2.amazonaws.com",partition:"aws"};break;case"accesspoint-eu-west-3":n={hostname:"s3-accesspoint.eu-west-3.amazonaws.com",partition:"aws"};break;case"accesspoint-me-south-1":n={hostname:"s3-accesspoint.me-south-1.amazonaws.com",partition:"aws"};break;case"accesspoint-sa-east-1":n={hostname:"s3-accesspoint.sa-east-1.amazonaws.com",partition:"aws"};break;case"accesspoint-us-east-1":n={hostname:"s3-accesspoint.us-east-1.amazonaws.com",partition:"aws"};break;case"accesspoint-us-east-2":n={hostname:"s3-accesspoint.us-east-2.amazonaws.com",partition:"aws"};break;case"accesspoint-us-gov-east-1":n={hostname:"s3-accesspoint.us-gov-east-1.amazonaws.com",partition:"aws-us-gov"};break;case"accesspoint-us-gov-west-1":n={hostname:"s3-accesspoint.us-gov-west-1.amazonaws.com",partition:"aws-us-gov"};break;case"accesspoint-us-west-1":n={hostname:"s3-accesspoint.us-west-1.amazonaws.com",partition:"aws"};break;case"accesspoint-us-west-2":n={hostname:"s3-accesspoint.us-west-2.amazonaws.com",partition:"aws"};break;case"af-south-1":n={hostname:"s3.af-south-1.amazonaws.com",partition:"aws"};break;case"ap-east-1":n={hostname:"s3.ap-east-1.amazonaws.com",partition:"aws"};break;case"ap-northeast-1":n={hostname:"s3.ap-northeast-1.amazonaws.com",partition:"aws"};break;case"ap-northeast-2":n={hostname:"s3.ap-northeast-2.amazonaws.com",partition:"aws"};break;case"ap-northeast-3":n={hostname:"s3.ap-northeast-3.amazonaws.com",partition:"aws"};break;case"ap-south-1":n={hostname:"s3.ap-south-1.amazonaws.com",partition:"aws"};break;case"ap-southeast-1":n={hostname:"s3.ap-southeast-1.amazonaws.com",partition:"aws"};break;case"ap-southeast-2":n={hostname:"s3.ap-southeast-2.amazonaws.com",partition:"aws"};break;case"aws-global":n={hostname:"s3.amazonaws.com",partition:"aws",signingRegion:"us-east-1"};break;case"ca-central-1":n={hostname:"s3.ca-central-1.amazonaws.com",partition:"aws"};break;case"cn-north-1":n={hostname:"s3.cn-north-1.amazonaws.com.cn",partition:"aws-cn"};break;case"cn-northwest-1":n={hostname:"s3.cn-northwest-1.amazonaws.com.cn",partition:"aws-cn"};break;case"eu-central-1":n={hostname:"s3.eu-central-1.amazonaws.com",partition:"aws"};break;case"eu-north-1":n={hostname:"s3.eu-north-1.amazonaws.com",partition:"aws"};break;case"eu-south-1":n={hostname:"s3.eu-south-1.amazonaws.com",partition:"aws"};break;case"eu-west-1":n={hostname:"s3.eu-west-1.amazonaws.com",partition:"aws"};break;case"eu-west-2":n={hostname:"s3.eu-west-2.amazonaws.com",partition:"aws"};break;case"eu-west-3":n={hostname:"s3.eu-west-3.amazonaws.com",partition:"aws"};break;case"fips-accesspoint-ca-central-1":n={hostname:"s3-accesspoint-fips.ca-central-1.amazonaws.com",partition:"aws"};break;case"fips-accesspoint-us-east-1":n={hostname:"s3-accesspoint-fips.us-east-1.amazonaws.com",partition:"aws"};break;case"fips-accesspoint-us-east-2":n={hostname:"s3-accesspoint-fips.us-east-2.amazonaws.com",partition:"aws"};break;case"fips-accesspoint-us-gov-east-1":n={hostname:"s3-accesspoint-fips.us-gov-east-1.amazonaws.com",partition:"aws-us-gov"};break;case"fips-accesspoint-us-gov-west-1":n={hostname:"s3-accesspoint-fips.us-gov-west-1.amazonaws.com",partition:"aws-us-gov"};break;case"fips-accesspoint-us-west-1":n={hostname:"s3-accesspoint-fips.us-west-1.amazonaws.com",partition:"aws"};break;case"fips-accesspoint-us-west-2":n={hostname:"s3-accesspoint-fips.us-west-2.amazonaws.com",partition:"aws"};break;case"fips-us-gov-west-1":n={hostname:"s3-fips.us-gov-west-1.amazonaws.com",partition:"aws-us-gov",signingRegion:"us-gov-west-1"};break;case"me-south-1":n={hostname:"s3.me-south-1.amazonaws.com",partition:"aws"};break;case"s3-external-1":n={hostname:"s3-external-1.amazonaws.com",partition:"aws",signingRegion:"us-east-1"};break;case"sa-east-1":n={hostname:"s3.sa-east-1.amazonaws.com",partition:"aws"};break;case"us-east-1":n={hostname:"s3.us-east-1.amazonaws.com",partition:"aws"};break;case"us-east-2":n={hostname:"s3.us-east-2.amazonaws.com",partition:"aws"};break;case"us-gov-east-1":n={hostname:"s3.us-gov-east-1.amazonaws.com",partition:"aws-us-gov"};break;case"us-gov-west-1":n={hostname:"s3.us-gov-west-1.amazonaws.com",partition:"aws-us-gov"};break;case"us-iso-east-1":n={hostname:"s3.us-iso-east-1.c2s.ic.gov",partition:"aws-iso"};break;case"us-isob-east-1":n={hostname:"s3.us-isob-east-1.sc2s.sgov.gov",partition:"aws-iso-b"};break;case"us-west-1":n={hostname:"s3.us-west-1.amazonaws.com",partition:"aws"};break;case"us-west-2":n={hostname:"s3.us-west-2.amazonaws.com",partition:"aws"};break;default:La.has(e)&&(n={hostname:"s3.{region}.amazonaws.com".replace("{region}",e),partition:"aws"}),Na.has(e)&&(n={hostname:"s3.{region}.amazonaws.com.cn".replace("{region}",e),partition:"aws-cn"}),Da.has(e)&&(n={hostname:"s3.{region}.c2s.ic.gov".replace("{region}",e),partition:"aws-iso"}),Ua.has(e)&&(n={hostname:"s3.{region}.sc2s.sgov.gov".replace("{region}",e),partition:"aws-iso-b"}),qa.has(e)&&(n={hostname:"s3.{region}.amazonaws.com".replace("{region}",e),partition:"aws-us-gov"}),void 0===n&&(n={hostname:"s3.{region}.amazonaws.com".replace("{region}",e),partition:"aws"})}return Promise.resolve({signingService:"s3",...n})},serviceId:"S3",signingEscapePath:!1,urlParser:tr,useArnRegion:!1},Ma={...ja,runtime:"node",base64Decoder:Hn,base64Encoder:Fn,bodyLengthChecker:Vn,credentialDefaultProvider:function(t){return function(n){return t(e.__assign({roleAssumer:(r=n,void 0===r&&(r={}),ht(r,ea)),roleAssumerWithWebIdentity:ta(n)},n));var r}}(Fr),defaultUserAgentProvider:Bn({serviceId:ja.serviceId,clientVersion:$}),eventStreamSerdeProvider:function(e){return new Ca(e)},maxAttempts:Un(zn),md5:pn.bind(null,"md5"),region:Un(wt,yt),requestHandler:new Kn,retryModeProvider:Un(Nn),sha256:pn.bind(null,"sha256"),streamCollector:$n,streamHasher:function(e,t){return new Promise((function(n,r){if("string"==typeof t.path){var s=a.createReadStream(t.path,{start:t.start,end:t.end}),o=new e,i=new za(o);s.pipe(i),s.on("error",(function(e){i.end(),r(e)})),i.on("error",r),i.on("finish",(function(){o.digest().then(n).catch(r)}))}else r(new Error("Unable to calculate hash for non-file streams."))}))},useArnRegion:Un(Oa),utf8Decoder:Gn,utf8Encoder:Xn};var Ka={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},Wa=function(t){return{applyToStack:function(n){n.add(function(t){var n=this;return function(r){return function(a){return e.__awaiter(n,void 0,void 0,(function(){var n;return e.__generator(this,(function(s){return n=a.request,u.HttpRequest.isInstance(n)&&n.body&&"node"===t.runtime&&(n.headers=e.__assign(e.__assign({},n.headers),{Expect:"100-continue"})),[2,r(e.__assign(e.__assign({},a),{request:n}))]}))}))}}}(t),Ka)}}};var $a={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},Ha=function(t){return{applyToStack:function(t){t.add(function(){var t=this;return function(n){return function(r){return e.__awaiter(t,void 0,void 0,(function(){var t,a;return e.__generator(this,(function(s){if("string"==typeof(t=r.input.Bucket)&&!u.validate(t)&&t.indexOf("/")>=0)throw(a=new Error("Bucket name shouldn't contain '/', received '"+t+"'")).name="InvalidBucketName",a;return[2,n(e.__assign({},r))]}))}))}}}(),$a)}}},Fa={step:"build",tags:["USE_REGIONAL_ENDPOINT","S3"],name:"useRegionalEndpointMiddleware",override:!0},Va=function(t){return{applyToStack:function(n){n.add(function(t){return function(n){return function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var a,s;return e.__generator(this,(function(o){switch(o.label){case 0:return a=r.request,!u.HttpRequest.isInstance(a)||t.isCustomEndpoint?[2,n(e.__assign({},r))]:"s3.amazonaws.com"!==a.hostname?[3,1]:(a.hostname="s3.us-east-1.amazonaws.com",[3,3]);case 1:return s="aws-global",[4,t.region()];case 2:s===o.sent()&&(a.hostname="s3.amazonaws.com"),o.label=3;case 3:return[2,n(e.__assign({},r))]}}))}))}}}(t),Fa)}}};class Ba extends u.Client{constructor(t){let n={...Ma,...t},r=bt(n),a=mt(r),s=On(a),o=at(s);var i,c,u,l,d,f,v,h,p,m,g;let _=function(t){return e.__assign(e.__assign({},t),{eventStreamMarshaller:t.eventStreamSerdeProvider(t)})}(lr((c=(i=o).bucketEndpoint,u=void 0!==c&&c,l=i.forcePathStyle,d=void 0!==l&&l,f=i.useAccelerateEndpoint,v=void 0!==f&&f,h=i.useDualstackEndpoint,p=void 0!==h&&h,m=i.useArnRegion,g=void 0!==m&&m,e.__assign(e.__assign({},i),{bucketEndpoint:u,forcePathStyle:d,useAccelerateEndpoint:v,useDualstackEndpoint:p,useArnRegion:"function"==typeof g?g:function(){return Promise.resolve(g)}}))));super(_),this.config=_,this.middlewareStack.use(wn(this.config)),this.middlewareStack.use(sr(this.config)),this.middlewareStack.use(ir(this.config)),this.middlewareStack.use(ur(this.config)),this.middlewareStack.use(lt(this.config)),this.middlewareStack.use(Ha(this.config)),this.middlewareStack.use(Va(this.config)),this.middlewareStack.use(Wa(this.config)),this.middlewareStack.use(Rr(this.config))}destroy(){super.destroy()}}exports.S3Client=Ba;
